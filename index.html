<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maritime Loop: Ottawa, PEI & NS Planner</title>
    
    <!-- CSS Framework -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Charting & Maps -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        
        /* Interactive Tab Styles */
        .tab-active { border-bottom: 3px solid #0891b2; color: #0e7490; font-weight: 700; background-color: rgba(8, 145, 178, 0.05); }
        .tab-inactive { color: #64748b; font-weight: 500; }
        .tab-inactive:hover { color: #334155; background-color: #f1f5f9; }
        
        /* Chart & Map Containers */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin: 0 auto;
            height: 350px;
            max-height: 400px;
        }
        #map {
            width: 100%;
            height: 500px;
            border-radius: 0.75rem;
            z-index: 1;
        }
        .map-wrapper {
            position: relative;
            border-radius: 0.75rem;
            border: 1px solid #cbd5e1;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        /* Timeline Graphics */
        .timeline-line {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background-color: #e2e8f0;
            z-index: 0;
        }

        /* Hero Image Overlay */
        .hero-bg {
            background-image: linear-gradient(rgba(14, 116, 144, 0.85), rgba(15, 23, 42, 0.8)), url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Peggy%27s_Cove_Lighthouse_Nova_Scotia.jpg/1280px-Peggy%27s_Cove_Lighthouse_Nova_Scotia.jpg');
            background-size: cover;
            background-position: center 30%;
        }

        /* Login Overlay */
        #login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.98);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- PASSWORD OVERLAY -->
    <div id="login-overlay">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center border-4 border-cyan-500/20">
            <div class="text-5xl mb-6">üîí</div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Maritime Planner</h2>
            <p class="text-sm text-slate-500 mb-6">Enter password to view itinerary.</p>
            
            <input type="password" id="password-input" placeholder="Enter password" 
                   class="w-full p-3 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-cyan-500 outline-none transition text-center text-lg">
            
            <button onclick="checkPassword()" 
                    class="w-full bg-cyan-700 text-white font-bold py-3 rounded-lg hover:bg-cyan-800 transition shadow-lg transform active:scale-95">
                Unlock Plan
            </button>
            <p id="error-msg" class="text-red-500 text-xs mt-3 hidden font-bold">Incorrect password.</p>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div id="app-container" class="hidden max-w-7xl mx-auto min-h-screen flex flex-col bg-slate-50 shadow-2xl my-0 md:my-8 rounded-2xl overflow-hidden">
        
        <!-- Hero Header -->
        <header class="hero-bg text-white p-8 md:p-12 shadow-lg">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold tracking-tight mb-2">The Maritime Loop</h1>
                    <p class="text-cyan-100 text-xl font-light">Ottawa &#8594; PEI &#8594; Nova Scotia &#8594; Ottawa</p>
                </div>
                <div class="mt-6 md:mt-0 bg-white/10 backdrop-blur-md px-6 py-3 rounded-xl border border-white/20">
                    <span class="block text-xs text-cyan-200 uppercase tracking-widest font-bold mb-1">Trip Profile</span>
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">üöê</span>
                            <span class="font-bold" id="header-travelers">6 Travelers</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">üõ£Ô∏è</span>
                            <span class="font-bold">~3,200km</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
            <div class="flex overflow-x-auto px-4 md:px-8">
                <button onclick="switchTab('route')" id="tab-route" class="tab-active py-5 px-6 whitespace-nowrap transition-all flex items-center">
                    <span class="mr-2">üó∫Ô∏è</span> Map & Route
                </button>
                <button onclick="switchTab('budget')" id="tab-budget" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center">
                    <span class="mr-2">üí∞</span> Smart Budget
                </button>
                <button onclick="switchTab('attractions')" id="tab-attractions" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center">
                    <span class="mr-2">üì∏</span> Must-See
                </button>
                <button onclick="switchTab('logistics')" id="tab-logistics" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center">
                    <span class="mr-2">üìã</span> Logistics
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-grow p-4 md:p-8">

            <!-- TAB: ROUTE -->
            <section id="content-route" class="space-y-8 animate-fade-in">
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                    <div class="flex justify-between items-end mb-6">
                        <div>
                            <h2 class="text-2xl font-bold text-slate-800">Interactive Map</h2>
                            <p class="text-slate-600">Zoom in to see the roads. <span class="text-amber-600 font-bold">Orange dashed line</span> is the ferry.</p>
                        </div>
                    </div>

                    <!-- Leaflet Map Container -->
                    <div class="map-wrapper">
                        <div id="map"></div>
                    </div>
                    
                    <!-- Timeline -->
                    <div class="mt-12 relative">
                        <div class="hidden md:block timeline-line"></div>

                        <!-- Stop 1 -->
                        <div class="flex flex-col md:flex-row items-center mb-12 relative z-10">
                            <div class="w-full md:w-1/2 md:pr-12 text-center md:text-right mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-cyan-900">Start: Ottawa, ON</h3>
                                <p class="text-slate-500 font-medium">Day 1: 07:00 AM</p>
                                <p class="text-sm text-slate-600 mt-2 bg-slate-50 p-3 rounded-lg inline-block">The long haul. Drive 7 hours to Edmundston, NB. Stop in Quebec City for lunch if time permits.</p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-cyan-600 border-4 border-white shadow-lg flex items-center justify-center text-white font-bold">1</div>
                            <div class="w-full md:w-1/2 md:pl-12 hidden md:block"></div>
                        </div>

                        <!-- Stop 2 -->
                        <div class="flex flex-col md:flex-row items-center mb-12 relative z-10">
                            <div class="w-full md:w-1/2 md:pr-12 hidden md:block"></div>
                            <div class="w-10 h-10 rounded-full bg-amber-500 border-4 border-white shadow-lg flex items-center justify-center text-white font-bold">2</div>
                            <div class="w-full md:w-1/2 md:pl-12 text-center md:text-left mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-slate-800">PEI Arrival (Bridge)</h3>
                                <p class="text-slate-500 font-medium">Days 2-4</p>
                                <p class="text-sm text-slate-600 mt-2 bg-slate-50 p-3 rounded-lg inline-block">Cross the 13km Confederation Bridge. Stay in Cavendish. Visit <strong class="text-cyan-700">Udit's Aunt</strong> and hit Brackley Beach.</p>
                            </div>
                        </div>

                        <!-- Stop 3 -->
                        <div class="flex flex-col md:flex-row items-center mb-12 relative z-10">
                            <div class="w-full md:w-1/2 md:pr-12 text-center md:text-right mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-slate-800">The Ferry Crossing</h3>
                                <p class="text-slate-500 font-medium">Day 5: Morning</p>
                                <p class="text-sm text-slate-600 mt-2 bg-slate-50 p-3 rounded-lg inline-block">Take the Wood Islands Ferry to Nova Scotia. A 75-minute break from driving. Book ahead!</p>
                            </div>
                            <div class="w-10 h-10 rounded-full bg-indigo-600 border-4 border-white shadow-lg flex items-center justify-center text-white font-bold">3</div>
                            <div class="w-full md:w-1/2 md:pl-12 hidden md:block"></div>
                        </div>

                        <!-- Stop 4 -->
                        <div class="flex flex-col md:flex-row items-center relative z-10">
                            <div class="w-full md:w-1/2 md:pr-12 hidden md:block"></div>
                            <div class="w-10 h-10 rounded-full bg-cyan-600 border-4 border-white shadow-lg flex items-center justify-center text-white font-bold">4</div>
                            <div class="w-full md:w-1/2 md:pl-12 text-center md:text-left mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-cyan-900">Nova Scotia Coast</h3>
                                <p class="text-slate-500 font-medium">Days 5-8</p>
                                <p class="text-sm text-slate-600 mt-2 bg-slate-50 p-3 rounded-lg inline-block">Halifax Waterfront, Peggy's Cove, Lunenburg. Drive home via New Brunswick on Day 9.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: BUDGET -->
            <section id="content-budget" class="hidden space-y-8 animate-fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Controls -->
                    <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <div class="flex justify-between items-center mb-4">
                            <h2 class="text-xl font-bold text-slate-800">Cost Estimator</h2>
                            <!-- GROUP SIZE TOGGLE -->
                            <div class="bg-slate-100 p-1 rounded-lg flex text-sm font-bold">
                                <button onclick="setGroupSize(4)" id="btn-pax-4" class="px-3 py-1 rounded transition-colors text-slate-500">4 Pax</button>
                                <button onclick="setGroupSize(6)" id="btn-pax-6" class="px-3 py-1 rounded transition-colors bg-white shadow text-cyan-700">6 Pax</button>
                            </div>
                        </div>
                        <p class="text-sm text-slate-500 mb-6" id="budget-desc">Calculating for a group of 6 (Minivan).</p>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Trip Duration (Days)</span>
                                    <span id="val-days" class="text-cyan-600 font-bold">8</span>
                                </label>
                                <input type="range" id="input-days" min="5" max="14" value="8" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Accom. / Night (Total)</span>
                                    <span class="text-cyan-600 font-bold">$<span id="val-accom">400</span></span>
                                </label>
                                <input type="range" id="input-accom" min="150" max="800" step="50" value="400" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                                <p class="text-xs text-slate-400 mt-1" id="accom-hint">For 6 people (approx 2 rooms/large Airbnb)</p>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Food / Person / Day</span>
                                    <span class="text-cyan-600 font-bold">$<span id="val-food">65</span></span>
                                </label>
                                <input type="range" id="input-food" min="30" max="150" step="5" value="65" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Gas Price (per L)</span>
                                    <span class="text-cyan-600 font-bold">$<span id="val-gas">1.65</span></span>
                                </label>
                                <input type="range" id="input-gas" min="1.30" max="2.20" step="0.05" value="1.65" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>
                        </div>

                        <div class="mt-8 pt-6 border-t border-slate-100">
                            <div class="flex justify-between items-end mb-2">
                                <span class="text-slate-600 font-medium">Total Cost</span>
                                <span id="total-cost" class="text-3xl font-bold text-slate-800">$0</span>
                            </div>
                            <div class="flex justify-between items-end bg-cyan-50 p-3 rounded-lg">
                                <span class="text-cyan-800 text-sm font-medium">Cost Per Person</span>
                                <span id="per-person-cost" class="text-xl font-bold text-cyan-700">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Visualization -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col justify-center">
                        <div class="chart-container">
                            <canvas id="budgetChart"></canvas>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-8 text-center">
                            <div class="p-4 bg-slate-50 rounded-xl border border-slate-100">
                                <div class="text-xs text-slate-500 uppercase tracking-wider font-bold mb-1">Transport</div>
                                <div id="stat-transport" class="font-bold text-slate-700 text-lg">-</div>
                            </div>
                            <div class="p-4 bg-slate-50 rounded-xl border border-slate-100">
                                <div class="text-xs text-slate-500 uppercase tracking-wider font-bold mb-1">Stay</div>
                                <div id="stat-accom" class="font-bold text-slate-700 text-lg">-</div>
                            </div>
                            <div class="p-4 bg-slate-50 rounded-xl border border-slate-100">
                                <div class="text-xs text-slate-500 uppercase tracking-wider font-bold mb-1">Food</div>
                                <div id="stat-food" class="font-bold text-slate-700 text-lg">-</div>
                            </div>
                            <div class="p-4 bg-slate-50 rounded-xl border border-slate-100">
                                <div class="text-xs text-slate-500 uppercase tracking-wider font-bold mb-1">Activities</div>
                                <div id="stat-fun" class="font-bold text-slate-700 text-lg">-</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: ATTRACTIONS -->
            <section id="content-attractions" class="hidden space-y-8 animate-fade-in">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">Must-See Spots</h2>
                        <p class="text-slate-600">Curated specifically for this trip.</p>
                    </div>
                    <div class="flex space-x-2 mt-4 md:mt-0 flex-wrap gap-2">
                        <button onclick="filterAttractions('all')" class="px-4 py-2 text-sm bg-slate-800 text-white rounded-full shadow-md hover:bg-slate-700 transition">All</button>
                        <button onclick="filterAttractions('pei')" class="px-4 py-2 text-sm bg-white border border-amber-200 text-amber-700 rounded-full hover:bg-amber-50 transition font-bold shadow-sm">PEI</button>
                        <button onclick="filterAttractions('ns-nature')" class="px-4 py-2 text-sm bg-white border border-green-200 text-green-700 rounded-full hover:bg-green-50 transition font-bold shadow-sm">Nature</button>
                        <button onclick="filterAttractions('ns-culture')" class="px-4 py-2 text-sm bg-white border border-blue-200 text-blue-700 rounded-full hover:bg-blue-50 transition font-bold shadow-sm">Culture</button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="attraction-grid">
                    <!-- Cards injected by JS -->
                </div>
            </section>

            <!-- TAB: LOGISTICS -->
            <section id="content-logistics" class="hidden space-y-8 animate-fade-in">
                
                <!-- Wedding Strategy -->
                <div class="bg-gradient-to-r from-teal-800 to-teal-600 rounded-2xl shadow-xl overflow-hidden mb-8">
                    <div class="p-8 text-white border-b border-teal-700/30">
                        <div class="flex items-center">
                            <span class="text-4xl mr-4">üíç</span>
                            <div>
                                <h3 class="text-2xl font-bold">The "Pre-Wedding" Strategy</h3>
                                <p class="text-teal-100">Timing: Aug 1‚Äì9, 2026 (Civic Holiday)</p>
                            </div>
                        </div>
                    </div>
                    <div class="bg-white p-8 grid grid-cols-1 md:grid-cols-2 gap-8">
                        <div>
                            <h4 class="font-bold text-teal-800 mb-4 uppercase text-sm tracking-wide">Why this dates works</h4>
                            <ul class="space-y-4">
                                <li class="flex">
                                    <div class="flex-shrink-0 h-6 w-6 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-bold text-xs mr-3">1</div>
                                    <p class="text-sm text-slate-600"><strong>The Buffer:</strong> Gives you a full 2 months to relax before the October wedding chaos.</p>
                                </li>
                                <li class="flex">
                                    <div class="flex-shrink-0 h-6 w-6 rounded-full bg-teal-100 flex items-center justify-center text-teal-600 font-bold text-xs mr-3">2</div>
                                    <p class="text-sm text-slate-600"><strong>Best Weather:</strong> Early August is the only time the ocean is remotely warm enough for swimming without a wetsuit.</p>
                                </li>
                            </ul>
                        </div>
                        <div class="bg-amber-50 rounded-xl p-5 border border-amber-100">
                            <h4 class="font-bold text-amber-800 mb-2 flex items-center"><span class="mr-2">‚ö†Ô∏è</span> Critical To-Dos</h4>
                            <ul class="space-y-2 text-sm text-amber-900">
                                <li>‚Ä¢ Book Ferry (Wood Islands) by <strong>May 1st</strong>.</li>
                                <li>‚Ä¢ Book Accommodation by <strong>March 1st</strong> (Wedding season is busy in PEI too!).</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- Logistics Cards -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    <!-- Dynamic Vehicle Strategy Card -->
                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                         <div class="flex items-center mb-4">
                            <span class="text-3xl mr-3">üöê</span>
                            <h3 class="text-xl font-bold text-slate-800">Vehicle Strategy</h3>
                        </div>
                        <div id="logistics-vehicle-content">
                            <!-- Injected by JS based on Group Size -->
                        </div>
                    </div>

                    <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <div class="flex items-center mb-4">
                           <span class="text-3xl mr-3">üè†</span>
                           <h3 class="text-xl font-bold text-slate-800">Accommodation</h3>
                       </div>
                       <p class="text-slate-600 text-sm mb-4">Tips for high season.</p>
                       <ul class="text-sm text-slate-600 space-y-2 list-disc pl-5">
                           <li><strong>PEI:</strong> Look for "Cottage Courts" in Cavendish or North Rustico.</li>
                           <li><strong>Halifax:</strong> Check Dalhousie University summer residence (cheap!) or Airbnbs in Dartmouth (ferry to downtown).</li>
                       </ul>
                   </div>
                </div>
            </section>
        </main>
        
        <footer class="bg-slate-800 text-slate-400 p-8 text-center text-sm">
            <p>&copy; 2026 Maritime Trip Planner. Built for your GitHub Portfolio.</p>
        </footer>
    </div>

    <script>
        // --- ASSETS (Stable Wikimedia Sources) ---
        const assets = {
            aunt: 'https://upload.wikimedia.org/wikipedia/commons/thumb/c/ca/716_%2C_Teahouse_Trek_-_Kanchenjunga_-_Nepal_%285645543787%29.jpg/640px-716_%2C_Teahouse_Trek_-_Kanchenjunga_-_Nepal_%285645543787%29.jpg',
            anne: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/87/Green_Gables_front_view.jpg/640px-Green_Gables_front_view.jpg', 
            brackley: 'https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Prince_Edward_Island_National_Park_Brackley_Beach.jpg/640px-Prince_Edward_Island_National_Park_Brackley_Beach.jpg',
            basin: 'https://upload.wikimedia.org/wikipedia/commons/thumb/d/d7/Basin_Head_beach.jpg/640px-Basin_Head_beach.jpg',
            charlottetown: 'https://upload.wikimedia.org/wikipedia/commons/thumb/2/22/Charlottetown_PEI_waterfront.jpg/640px-Charlottetown_PEI_waterfront.jpg', 
            hopewell: 'https://upload.wikimedia.org/wikipedia/commons/thumb/f/f6/Hopewell_Rocks_Low_Tide.jpg/640px-Hopewell_Rocks_Low_Tide.jpg', 
            peggy: 'https://upload.wikimedia.org/wikipedia/commons/thumb/e/e6/Peggy%27s_Cove_Lighthouse_Nova_Scotia.jpg/640px-Peggy%27s_Cove_Lighthouse_Nova_Scotia.jpg', 
            halifax: 'https://upload.wikimedia.org/wikipedia/commons/thumb/3/36/Halifax_Waterfront_Boardwalk.jpg/640px-Halifax_Waterfront_Boardwalk.jpg', 
            lunenburg: 'https://upload.wikimedia.org/wikipedia/commons/thumb/8/84/Lunenburg_Waterfront_August_2013.jpg/640px-Lunenburg_Waterfront_August_2013.jpg'
        };

        const attractionsData = [
            {
                title: "Udit's Aunt's House",
                category: "pei",
                location: "Prince Edward Island",
                description: "Family visit! The highlight of the PEI leg. Time for tea and catching up.",
                image: assets.aunt
            },
            {
                title: "Anne of Green Gables",
                category: "pei",
                location: "Confederation Centre",
                description: "The world's longest-running annual musical. Runs June-Sept!",
                image: assets.anne
            },
            {
                title: "Brackley Beach",
                category: "pei",
                location: "PEI National Park",
                description: "Massive dunes and endless sand. Great for sunset walks.",
                image: assets.brackley
            },
            {
                title: "Basin Head",
                category: "pei",
                location: "Eastern PEI",
                description: "Singing Sands! The sand squeaks when you walk. Jump off the bridge!",
                image: assets.basin
            },
            {
                title: "Charlottetown & Cows",
                category: "pei",
                location: "Victoria Row",
                description: "Historic waterfront, tall ships, and the best ice cream in Canada.",
                image: assets.charlottetown
            },
            {
                title: "Hopewell Rocks",
                category: "ns-nature",
                location: "New Brunswick",
                description: "Walk on the ocean floor at low tide. 16 meter tides!",
                image: assets.hopewell
            },
            {
                title: "Peggy's Cove",
                category: "ns-nature",
                location: "Nova Scotia",
                description: "The iconic lighthouse on granite rocks. Visit early to beat buses.",
                image: assets.peggy
            },
            {
                title: "Halifax Waterfront",
                category: "ns-culture",
                location: "Halifax, NS",
                description: "Walk the boardwalk, Maritime Museum, and ... yes, more Cows Ice Cream.",
                image: assets.halifax
            },
            {
                title: "Lunenburg",
                category: "ns-culture",
                location: "South Shore, NS",
                description: "UNESCO World Heritage site. Colorful buildings and the Bluenose II.",
                image: assets.lunenburg
            }
        ];

        let budgetChartInstance = null;
        let mapInstance = null;
        
        // --- STATE: GROUP SIZE ---
        let groupSize = 6; // Default

        // --- PASSWORD LOGIC ---
        function checkPassword() {
            const input = document.getElementById('password-input').value;
            const errorMsg = document.getElementById('error-msg');
            const overlay = document.getElementById('login-overlay');
            const app = document.getElementById('app-container');

            if (input.toLowerCase() === 'maritime') {
                overlay.style.opacity = '0';
                overlay.style.transition = 'opacity 0.6s ease-out';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    app.classList.remove('hidden');
                    setTimeout(initLeafletMap, 100);
                }, 600);
            } else {
                errorMsg.classList.remove('hidden');
                document.getElementById('password-input').classList.add('border-red-500');
                setTimeout(() => document.getElementById('password-input').classList.remove('border-red-500'), 500);
            }
        }
        document.getElementById('password-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') checkPassword();
        });

        // --- MAP LOGIC ---
        function initLeafletMap() {
            if (mapInstance) return; 

            mapInstance = L.map('map', { scrollWheelZoom: false }).setView([46.4, -64.5], 6);

            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', {
                attribution: '&copy; OpenStreetMap',
                subdomains: 'abcd',
                maxZoom: 19
            }).addTo(mapInstance);

            const locs = {
                ottawa: [45.4215, -75.6972],
                qc: [46.8139, -71.2080],
                edmundston: [47.3665, -68.3295],
                moncton: [46.0878, -64.7782],
                bridge: [46.215, -63.743], 
                pei_cavendish: [46.4913, -63.3768],
                ferry_pei: [45.9529, -62.7486], 
                ferry_ns: [45.7276, -62.6841], 
                halifax: [44.6488, -63.5752]
            };

            const drivePath1 = [locs.ottawa, locs.qc, locs.edmundston, locs.moncton, locs.bridge, locs.pei_cavendish];
            L.polyline(drivePath1, {color: '#0891b2', weight: 5, opacity: 0.8}).addTo(mapInstance);
            
            L.polyline([locs.pei_cavendish, locs.ferry_pei], {color: '#0891b2', weight: 5, opacity: 0.8}).addTo(mapInstance);
            L.polyline([locs.ferry_pei, locs.ferry_ns], {color: '#f59e0b', weight: 4, dashArray: '12, 12'}).addTo(mapInstance);
            L.polyline([locs.ferry_ns, locs.halifax], {color: '#0891b2', weight: 5, opacity: 0.8}).addTo(mapInstance);
            L.polyline([locs.halifax, locs.moncton], {color: '#64748b', weight: 3, dashArray: '6, 10', opacity: 0.6}).addTo(mapInstance);

            const iconDefault = L.icon({
                iconUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon.png',
                iconRetinaUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-icon-2x.png',
                shadowUrl: 'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',
                iconSize: [25, 41],
                iconAnchor: [12, 41],
                popupAnchor: [1, -34],
                shadowSize: [41, 41]
            });

            const markers = [
                { coords: locs.ottawa, title: "Start: Ottawa" },
                { coords: locs.edmundston, title: "Stopover: Edmundston" },
                { coords: locs.pei_cavendish, title: "PEI: Family & Beach" },
                { coords: locs.ferry_pei, title: "Ferry Terminal" },
                { coords: locs.halifax, title: "Halifax: Waterfront" }
            ];

            markers.forEach(m => {
                L.marker(m.coords, {icon: iconDefault}).addTo(mapInstance).bindPopup(`<b>${m.title}</b>`);
            });
            
            setTimeout(() => { mapInstance.invalidateSize(); }, 200);
        }

        // --- TABS ---
        function switchTab(tabId) {
            ['route', 'budget', 'attractions', 'logistics'].forEach(id => {
                document.getElementById(`content-${id}`).classList.add('hidden');
                document.getElementById(`tab-${id}`).classList.remove('tab-active');
                document.getElementById(`tab-${id}`).classList.add('tab-inactive');
            });
            document.getElementById(`content-${tabId}`).classList.remove('hidden');
            const activeTab = document.getElementById(`tab-${tabId}`);
            activeTab.classList.add('tab-active');
            activeTab.classList.remove('tab-inactive');
            
            if(tabId === 'budget' && budgetChartInstance) { budgetChartInstance.resize(); }
            if(tabId === 'route' && mapInstance) { setTimeout(() => { mapInstance.invalidateSize(); }, 100); }
        }

        function renderAttractions(filter) {
            const grid = document.getElementById('attraction-grid');
            grid.innerHTML = '';
            attractionsData.forEach(item => {
                if (filter !== 'all' && filter === 'pei' && item.title.includes('Aunt')) {
                } else if (filter !== 'all' && item.category !== filter) return;

                const card = document.createElement('div');
                card.className = "bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden hover:shadow-2xl transition-all duration-300 transform hover:-translate-y-1 group";
                
                let tagColor = item.category === 'pei' ? 'bg-amber-100 text-amber-800' : 'bg-blue-100 text-blue-800';
                if (item.title.includes('Aunt')) tagColor = 'bg-purple-100 text-purple-800';
                let tagLabel = item.title.includes('Aunt') ? 'Family' : (item.category === 'pei' ? 'PEI' : 'Nova Scotia');

                card.innerHTML = `
                    <div class="h-48 overflow-hidden relative">
                        <img src="${item.image}" alt="${item.title}" onerror="this.src='https://placehold.co/600x400/e2e8f0/475569?text=Image+Unavailable'" class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110">
                        <div class="absolute top-4 right-4">
                            <span class="text-xs font-bold px-3 py-1 rounded-full uppercase tracking-wide shadow-sm ${tagColor}">${tagLabel}</span>
                        </div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-xl font-bold text-slate-800 mb-2 group-hover:text-cyan-700 transition-colors">${item.title}</h3>
                        <div class="flex items-center mb-3 text-slate-400 text-xs uppercase font-bold tracking-wider">
                            <span class="mr-1">üìç</span> ${item.location}
                        </div>
                        <p class="text-sm text-slate-600 leading-relaxed">${item.description}</p>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function filterAttractions(category) { renderAttractions(category); }

        // --- DYNAMIC GROUP SIZE LOGIC ---
        function setGroupSize(size) {
            groupSize = size;
            
            // UI Toggle States
            if (size === 4) {
                document.getElementById('btn-pax-4').className = "px-3 py-1 rounded transition-colors bg-white shadow text-cyan-700";
                document.getElementById('btn-pax-6').className = "px-3 py-1 rounded transition-colors text-slate-500 hover:bg-slate-200";
                document.getElementById('budget-desc').innerText = "Calculating for a group of 4 (SUV/Sedan).";
                document.getElementById('accom-hint').innerText = "For 4 people (1 room/med Airbnb)";
                // Adjust default accom input for 4 pax
                document.getElementById('input-accom').value = 250; 
                document.getElementById('val-accom').innerText = 250;
            } else {
                document.getElementById('btn-pax-4').className = "px-3 py-1 rounded transition-colors text-slate-500 hover:bg-slate-200";
                document.getElementById('btn-pax-6').className = "px-3 py-1 rounded transition-colors bg-white shadow text-cyan-700";
                document.getElementById('budget-desc').innerText = "Calculating for a group of 6 (Minivan).";
                document.getElementById('accom-hint').innerText = "For 6 people (approx 2 rooms/large Airbnb)";
                // Adjust default accom input for 6 pax
                document.getElementById('input-accom').value = 400; 
                document.getElementById('val-accom').innerText = 400;
            }

            // Update Header
            document.getElementById('header-travelers').innerText = `${size} Travelers`;

            // Update Vehicle Strategy Card
            updateLogisticsCard(size);

            // Recalculate
            updateBudget();
        }

        function updateLogisticsCard(size) {
            const container = document.getElementById('logistics-vehicle-content');
            if (size === 6) {
                container.innerHTML = `
                    <div class="p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500 mb-3">
                        <strong class="block text-blue-900">The 6-Passenger Dilemma</strong>
                        <p class="text-sm text-slate-700 mt-1">A standard SUV usually fits 5 comfortably. For 6 + luggage, you <strong>need</strong> a Minivan (Grand Caravan/Sienna) or a Full-Size SUV (Suburban).</p>
                    </div>
                    <div class="p-3 bg-slate-50 rounded-lg">
                        <strong class="block text-slate-800">Rental Tip</strong>
                        <p class="text-sm text-slate-600 mt-1">Book months in advance. Large vehicles sell out first.</p>
                    </div>
                `;
            } else {
                container.innerHTML = `
                    <div class="p-3 bg-green-50 rounded-lg border-l-4 border-green-500 mb-3">
                        <strong class="block text-green-900">Easy Vehicle Choice</strong>
                        <p class="text-sm text-slate-700 mt-1">For 4 people, a standard Mid-Size SUV (RAV4/CRV) or a large Sedan is perfect. You will save significantly on gas compared to a minivan.</p>
                    </div>
                    <div class="p-3 bg-slate-50 rounded-lg">
                        <strong class="block text-slate-800">Rental Tip</strong>
                        <p class="text-sm text-slate-600 mt-1">Standard SUVs are abundant, but booking early still secures better rates.</p>
                    </div>
                `;
            }
        }

        // --- BUDGET CALCULATOR ---
        function initBudgetCalc() {
            const inputs = ['days', 'accom', 'food', 'gas'];
            inputs.forEach(id => {
                document.getElementById(`input-${id}`).addEventListener('input', (e) => {
                    document.getElementById(`val-${id}`).innerText = e.target.value;
                    updateBudget();
                });
            });

            const ctx = document.getElementById('budgetChart').getContext('2d');
            budgetChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Transport', 'Accommodation', 'Food', 'Fun/Ferry'],
                    datasets: [{
                        data: [10, 10, 10, 10],
                        backgroundColor: ['#0891b2', '#f59e0b', '#10b981', '#6366f1'],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom', labels: { usePointStyle: true, padding: 20 } },
                        tooltip: { 
                            callbacks: { label: function(context) { return ' $' + context.raw.toLocaleString(); } },
                            backgroundColor: 'rgba(15, 23, 42, 0.9)',
                            padding: 12
                        }
                    },
                    cutout: '70%'
                }
            });
            updateBudget();
            // Init default vehicle card
            updateLogisticsCard(6);
        }

        function updateBudget() {
            const days = parseInt(document.getElementById('input-days').value);
            const accomPerNight = parseInt(document.getElementById('input-accom').value);
            const foodPerPerson = parseInt(document.getElementById('input-food').value);
            const gasPrice = parseFloat(document.getElementById('input-gas').value);

            // Logic changes based on Group Size
            const kmDistance = 3500; 
            // Minivan (6pax) ~11L/100km vs SUV (4pax) ~9L/100km
            const fuelEfficiency = groupSize === 6 ? 11 : 9; 
            
            // Ferry Math: ~$90 Car + ~$20 per extra adult passenger
            // 4 pax = 90 + (3*20) = 150
            // 6 pax = 90 + (5*20) = 190
            const ferryBase = 90 + ((groupSize - 1) * 20);
            
            // Fun Budget: ~$10/day/person base
            const funTotal = (days * 10 * groupSize);
            
            const ferryAndFun = ferryBase + funTotal;

            const gasCost = Math.round((kmDistance / 100) * fuelEfficiency * gasPrice);
            const accomCost = accomPerNight * days;
            const foodCost = foodPerPerson * groupSize * days;
            const totalCost = gasCost + accomCost + foodCost + ferryAndFun;
            const perPerson = Math.round(totalCost / groupSize);

            document.getElementById('total-cost').innerText = '$' + totalCost.toLocaleString();
            document.getElementById('per-person-cost').innerText = '$' + perPerson.toLocaleString();
            document.getElementById('stat-transport').innerText = '$' + gasCost;
            document.getElementById('stat-accom').innerText = '$' + accomCost;
            document.getElementById('stat-food').innerText = '$' + foodCost;
            document.getElementById('stat-fun').innerText = '$' + ferryAndFun;

            budgetChartInstance.data.datasets[0].data = [gasCost, accomCost, foodCost, ferryAndFun];
            budgetChartInstance.update();
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderAttractions('all');
            initBudgetCalc();
        });

    </script>
</body>
</html>