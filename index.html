<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="no-referrer" />
  <title>Maritime Explorer: The Nature Loop</title>

  <!-- Tailwind + Chart.js + Leaflet + Lucide -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" crossorigin="" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" crossorigin=""></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <style>
    body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
    .tab-active { border-bottom: 3px solid #db2777; color: #be185d; font-weight: 700; background-color: rgba(219, 39, 119, 0.05); }
    .tab-inactive { color: #64748b; font-weight: 500; }
    .tab-inactive:hover { color: #334155; background-color: #f1f5f9; }
    #map { width: 100%; height: 500px; border-radius: 0.75rem; z-index: 1; }
    
    /* Hero */
    .hero-bg {
      background-image: linear-gradient(rgba(190, 24, 93, 0.85), rgba(88, 28, 135, 0.8)),
        url('https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?q=80&w=1920&auto=format&fit=crop');
      background-size: cover;
      background-position: center 40%;
    }

    /* Login overlay */
    #login-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(15, 23, 42, 0.98);
      z-index: 9999;
      display: flex;
      justify-content: center;
      align-items: center;
    }

    @keyframes pulse-red {
      0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); }
      70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); }
      100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); }
    }
    .animate-pulse-red { animation: pulse-red 2s infinite; }

    details > summary { list-style: none; cursor: pointer; }
    details > summary::-webkit-details-marker { display: none; }
    details[open] summary ~ * { animation: slideDown 0.25s ease-in-out; }
    @keyframes slideDown { 0% { opacity: 0; transform: translateY(-8px); } 100% { opacity: 1; transform: translateY(0); } }

    /* Toast */
    #toast { position: fixed; bottom: 18px; left: 50%; transform: translateX(-50%); z-index: 10000; }
    
    .img-fallback { background-color: #fce7f3; background-image: radial-gradient(#db2777 0.5px, #fce7f3 0.5px); background-size: 10px 10px; display: flex; align-items: center; justify-content: center; color: #be185d; font-weight: bold; text-transform: uppercase; font-size: 0.75rem; }
    
    /* Day Card Images */
    .day-img-strip { display: grid; grid-template-columns: repeat(2, 1fr); gap: 0.5rem; margin-top: 1rem; }
    .day-img { height: 120px; border-radius: 0.5rem; overflow: hidden; background: #f1f5f9; position: relative; }
    .day-img img { width: 100%; height: 100%; object-fit: cover; }
  </style>
</head>
<body class="text-slate-800">

  <!-- PASSWORD OVERLAY -->
  <div id="login-overlay">
    <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center border-4 border-pink-500/20">
      <div class="text-5xl mb-6">üîí</div>
      <h2 class="text-2xl font-bold text-slate-800 mb-2">Maritime Planner</h2>
      <p class="text-sm text-slate-500 mb-6">Enter password to view itinerary.</p>
      <input type="password" id="password-input" placeholder="Enter password" class="w-full p-3 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-pink-500 outline-none transition text-center text-lg">
      <button onclick="checkPassword()" class="w-full bg-pink-700 text-white font-bold py-3 rounded-lg hover:bg-pink-800 transition shadow-lg transform active:scale-95">Unlock Plan</button>
      <p id="error-msg" class="text-red-500 text-xs mt-3 hidden font-bold">Incorrect password.</p>
    </div>
  </div>

  <!-- TOAST -->
  <div id="toast" class="hidden">
    <div class="bg-slate-900 text-white text-sm px-4 py-3 rounded-xl shadow-xl border border-white/10 flex items-center gap-2">
      <span id="toast-icon">‚úÖ</span>
      <span id="toast-text">Copied!</span>
    </div>
  </div>

  <!-- MAIN APP CONTAINER -->
  <div id="app-container" class="hidden max-w-7xl mx-auto min-h-screen flex flex-col bg-slate-50 shadow-2xl my-0 md:my-8 rounded-2xl overflow-hidden">

    <!-- Hero Header -->
    <header class="hero-bg text-white p-8 md:p-12 shadow-lg">
      <div class="flex flex-col md:flex-row justify-between items-start md:items-center gap-6">
        <div>
          <h1 class="text-4xl md:text-5xl font-bold tracking-tight mb-2">The Nature Loop</h1>
          <p class="text-pink-100 text-xl font-light">Ottawa ‚Üí PEI Wildlife ‚Üí Fundy ‚Üí RDL Whales ‚Üí Ottawa</p>
          <div class="mt-4 flex flex-wrap gap-2">
            <span class="inline-flex items-center gap-2 bg-white/10 border border-white/15 px-3 py-1.5 rounded-full text-sm">
              <span class="text-lg">üìÖ</span>
              <span id="trip-dates" class="font-semibold">Aug 15‚Äì22</span>
            </span>
          </div>
        </div>

        <div class="bg-white/10 backdrop-blur-md px-6 py-4 rounded-xl border border-white/20">
          <span class="block text-xs text-pink-200 uppercase tracking-widest font-bold mb-2">Trip Profile</span>
          <div class="grid grid-cols-2 gap-x-6 gap-y-2">
            <div class="flex items-center"><span class="text-2xl mr-2">üê∂</span><span class="font-bold">With Finn</span></div>
            <div class="flex items-center"><span class="text-2xl mr-2">ü¶Ö</span><span class="font-bold">Nature Focus</span></div>
            <div class="flex items-center"><span class="text-2xl mr-2">üöô</span><span class="font-bold">Kia Sportage</span></div>
            <div class="flex items-center"><span class="text-2xl mr-2">üíé</span><span class="font-bold">Hidden Gems</span></div>
          </div>
        </div>
      </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
      <div class="flex overflow-x-auto px-4 md:px-8 items-center">
        <button onclick="switchTab('route')" id="tab-route" class="tab-active py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üó∫Ô∏è</span> Daily Itinerary</button>
        <button onclick="switchTab('budget')" id="tab-budget" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üí∞</span> Budget</button>
        <button onclick="switchTab('attractions')" id="tab-attractions" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">ü¶Ö</span> Wildlife & Gems</button>
        <button onclick="switchTab('photographers')" id="tab-photographers" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üì∏</span> Photographers</button>
        <button onclick="switchTab('wishlist')" id="tab-wishlist" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">‚ú®</span> Wishlist</button>
        <button onclick="switchTab('logistics')" id="tab-logistics" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üìã</span> Logistics <span class="ml-2 bg-red-500 text-white text-[10px] px-1 rounded animate-pulse">!</span></button>
      </div>
    </nav>

    <!-- Main Content Area -->
    <main class="flex-grow p-4 md:p-8">

      <!-- TAB: ROUTE -->
      <section id="content-route" class="space-y-8">

        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
            <div id="map"></div>
            <div class="mt-4 flex flex-wrap gap-2 text-sm text-slate-500">
               <span class="text-xs">Map shows the full scenic loop (NB -> PEI -> Fundy -> QC).</span>
            </div>
          </div>

          <aside class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
             <div class="space-y-6">
                <!-- Stats -->
                <div>
                   <div class="text-xs text-slate-400 uppercase font-bold tracking-widest mb-1">Total Distance</div>
                   <div class="text-3xl font-bold text-slate-800">~2,850 km</div>
                </div>
                <div>
                   <div class="text-xs text-slate-400 uppercase font-bold tracking-widest mb-1">Return Strategy</div>
                   <div class="text-xl font-bold text-green-600">Relaxed Split</div>
                   <div class="text-xs text-slate-500">Overnight in Rivi√®re-du-Loup</div>
                </div>
                <div>
                   <div class="text-xs text-slate-400 uppercase font-bold tracking-widest mb-1">Key Stops</div>
                   <ul class="text-sm space-y-1 text-slate-600">
                      <li>‚Ä¢ Trapper's Cabin (NB)</li>
                      <li>‚Ä¢ Stanhope Camp (PEI)</li>
                      <li>‚Ä¢ Alma/Fundy (NB)</li>
                      <li>‚Ä¢ RDL/Whales (QC)</li>
                   </ul>
                </div>
             </div>
          </aside>
        </div>

        <!-- Dynamic Timeline Container -->
        <div id="timeline-container" class="relative space-y-4">
             <!-- JavaScript will inject the days here -->
        </div>
      </section>

      <!-- TAB: BUDGET -->
      <section id="content-budget" class="hidden space-y-8">
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
          <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
            <h2 class="text-xl font-bold text-slate-800 mb-4">Cost Estimator</h2>
            <div class="space-y-6">
               <div class="space-y-2 text-sm">
                 <div class="flex justify-between bg-green-50 p-2 rounded border border-green-200"><span class="font-bold text-green-800">Cabin (Fixed)</span><span>$116</span></div>
                 <div class="flex justify-between bg-green-50 p-2 rounded border border-green-200"><span class="font-bold text-green-800">Camping (2 Nts)</span><span>~$100</span></div>
                 <div class="flex justify-between bg-blue-50 p-2 rounded border border-blue-200"><span class="font-bold text-blue-800">Whales (2 Tix)</span><span>~$200</span></div>
               </div>
               <div>
                 <label class="text-xs font-bold text-slate-500 uppercase">Avg Cost Remaining Nights (4)</label>
                 <div class="flex items-center gap-2"><input type="range" id="input-accom" min="120" max="400" step="10" value="180" class="flex-1 accent-pink-600"><span id="val-accom" class="font-bold w-12 text-right">180</span></div>
               </div>
               <div>
                 <label class="text-xs font-bold text-slate-500 uppercase">Food / Person / Day ($)</label>
                 <div class="flex items-center gap-2"><input type="range" id="input-food" min="40" max="200" step="5" value="75" class="flex-1 accent-pink-600"><span id="val-food" class="font-bold w-12 text-right">75</span></div>
               </div>
               <div>
                 <label class="text-xs font-bold text-slate-500 uppercase">Gas Price ($/L)</label>
                 <div class="flex items-center gap-2"><input type="range" id="input-gas" min="1.30" max="2.20" step="0.05" value="1.65" class="flex-1 accent-pink-600"><span id="val-gas" class="font-bold w-12 text-right">1.65</span></div>
               </div>
            </div>
            <div class="mt-8 pt-6 border-t border-slate-100 text-center">
                <div class="text-slate-500 text-sm">Estimated Total</div>
                <div id="total-cost" class="text-4xl font-bold text-slate-800">$0</div>
            </div>
          </div>
          <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col justify-center">
            <div class="relative w-full max-w-[400px] mx-auto h-[300px]">
              <canvas id="budgetChart"></canvas>
            </div>
          </div>
        </div>
      </section>

      <!-- TAB: ATTRACTIONS -->
      <section id="content-attractions" class="hidden space-y-8">
        <div class="flex gap-2 mb-6 overflow-x-auto pb-2">
            <button onclick="renderAttractions('all')" class="px-4 py-2 text-sm bg-slate-800 text-white rounded-full">All</button>
            <button onclick="renderAttractions('hidden')" class="px-4 py-2 text-sm bg-white border border-pink-200 text-pink-700 rounded-full font-bold">üíé Hidden Gems</button>
            <button onclick="renderAttractions('mammals')" class="px-4 py-2 text-sm bg-white border border-blue-200 text-blue-700 rounded-full font-bold">üêã Mammals</button>
            <button onclick="renderAttractions('birds')" class="px-4 py-2 text-sm bg-white border border-amber-200 text-amber-700 rounded-full font-bold">ü¶Ö Birding</button>
        </div>
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="attraction-grid"></div>
      </section>
      
      <!-- TAB: PHOTOGRAPHERS -->
      <section id="content-photographers" class="hidden space-y-8">
         <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
            <h2 class="text-2xl font-bold text-slate-800 mb-4">Engagement Photographers</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="photo-grid"></div>
         </div>
      </section>

      <!-- TAB: WISHLIST -->
      <section id="content-wishlist" class="hidden space-y-8">
          <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
             <h2 class="text-2xl font-bold text-slate-800 mb-4">Trip Wishlist</h2>
             <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="wishlist"></div>
          </div>
      </section>

      <!-- TAB: LOGISTICS -->
      <section id="content-logistics" class="hidden space-y-8">
          <div class="bg-red-50 border-l-4 border-red-500 p-6 rounded-r-xl shadow-sm mb-8 animate-pulse-red">
            <h3 class="text-xl font-bold text-red-700">CRITICAL: Stanhope Booking</h3>
            <p class="text-sm text-red-900 mt-1 font-semibold">Parks Canada Reservations Open: <span class="underline">Feb 9 @ 7:00 AM ET</span>.</p>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-blue-50 border border-blue-200 rounded-2xl shadow-sm p-6">
                <h3 class="text-xl font-bold text-blue-900 mb-4">üê∂ Finn's Plan (RDL)</h3>
                <ul class="text-sm text-slate-600 space-y-2 list-disc pl-4">
                    <li><strong>Friday PM:</strong> Walk at Parc de la Pointe.</li>
                    <li><strong>Saturday AM:</strong> Leave in hotel crate during whale tour.</li>
                    <li><strong>Saturday PM:</strong> Lunch walk before drive.</li>
                </ul>
            </div>
            
            <div class="bg-white rounded-2xl shadow-lg border border-green-100 p-6">
                <h3 class="text-lg font-bold flex items-center mb-2"><span class="text-2xl mr-2">‚úÖ</span> Trapper's Cabin Booked</h3>
                <p class="text-sm text-slate-600">Access confirmed for Kia Sportage.</p>
                <p class="text-sm text-amber-600 mt-2 font-bold">‚ö†Ô∏è Buy groceries in Grand Falls!</p>
            </div>
          </div>
      </section>

    </main>
    <footer class="bg-slate-800 text-slate-400 p-8 text-center text-sm"><p>&copy; 2026 Maritime Trip Planner.</p></footer>
  </div>

  <script>
    // --- DATA ---
    const itineraryData = [
        { day: 1, date: "Sat, Aug 15", title: "The Great Escape", route: "Ottawa ‚Üí Trapper's Cabin", color: "bg-pink-600",
          schedule: [
             { time: "07:00", text: "Depart Ottawa. 417 East." },
             { time: "12:30", text: "Lunch: Kamouraska (QC). üíé Hidden Gem village." },
             { time: "16:00", text: "Grand Falls, NB: Grocery Run (IGA). Last chance for supplies!" },
             { time: "17:30", text: "Check-in: Trapper's Cabin (Booked). ü¶â Listen for Barred Owls." }
          ],
          images: ["https://images.unsplash.com/photo-1596282247385-0552b75a1d7c?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1478131143081-80f7f84ca84d?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 2, date: "Sun, Aug 16", title: "Bridges & Boardwalks", route: "NB ‚Üí Stanhope, PEI", color: "bg-amber-500",
          schedule: [
             { time: "10:30", text: "Hartland Covered Bridge. üíé World's longest." },
             { time: "13:00", text: "Sackville Waterfowl Park. ‚≠ê Finn Spot (Dog friendly boardwalk)." },
             { time: "16:00", text: "Victoria-by-the-Sea. üíé Chocolates & Coffee." },
             { time: "17:30", text: "Camp Setup: Stanhope. ü¶ä Watch for Foxes in dunes." }
          ],
          images: ["https://images.unsplash.com/photo-1544636906-89689405d4b9?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1474511320723-9a56873867b5?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 3, date: "Mon, Aug 17", title: "Plovers & Auntie", route: "Stanhope Area", color: "bg-amber-500",
          schedule: [
             { time: "08:00", text: "Greenwich Dunes. ü¶Ö Piping Plovers nesting." },
             { time: "12:00", text: "Visit Udit's Aunt." },
             { time: "15:30", text: "Brackley Beach. ‚≠ê Wide beach for Finn (leash)." },
             { time: "17:30", text: "Dinner: Richard's Fresh Seafood (Covehead). Best lobster roll." }
          ],
          images: ["https://images.unsplash.com/photo-1552353617-3913788a1834?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 4, date: "Tue, Aug 18", title: "East End & City", route: "Stanhope ‚Üí Charlottetown", color: "bg-green-600",
          schedule: [
             { time: "10:30", text: "Wood Islands Lighthouse." },
             { time: "13:00", text: "Basin Head (Singing Sands). ‚≠ê Jump off the bridge!" },
             { time: "16:00", text: "Check-in Charlottetown B&B. Shower time!" },
             { time: "18:00", text: "Victoria Park Boardwalk. Dinner on Victoria Row." }
          ],
          images: ["https://images.unsplash.com/photo-1476673160081-cf060971a4ae?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1555685812-4b943f3e99a0?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 5, date: "Wed, Aug 19", title: "Cliffs & Bison", route: "Central PEI Loop", color: "bg-green-600",
          schedule: [
             { time: "10:00", text: "Buffaloland (Montague). ü¶¨ See the Bison herd." },
             { time: "13:00", text: "French River. üíé Postcard fishing village." },
             { time: "14:00", text: "Cape Tryon Lighthouse. üíé Red Cliffs (Less crowds)." },
             { time: "19:00", text: "Dinner: Blue Mussel Cafe (North Rustico)." }
          ],
          images: ["https://images.unsplash.com/photo-1505238240580-c0812e12822a?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1621882414734-7221e106950e?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 6, date: "Thu, Aug 20", title: "Tides & Birds", route: "PEI ‚Üí Alma, NB", color: "bg-teal-600",
          schedule: [
             { time: "09:00", text: "Depart PEI (Bridge). Stop at Cape Jourimain." },
             { time: "12:00", text: "Hopewell Rocks. ü¶Ö Peregrine Falcons." },
             { time: "14:00", text: "Mary's Point. üíé 200k+ Sandpipers migration." },
             { time: "17:00", text: "Arrive Alma. Stay motel/cottage." }
          ],
          images: ["https://images.unsplash.com/photo-1483729558449-99ef09a8c325?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1452570053594-1b985d6ea890?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 7, date: "Fri, Aug 21", title: "French Sunset", route: "Alma ‚Üí Rivi√®re-du-Loup", color: "bg-blue-600",
          schedule: [
             { time: "09:00", text: "Morning Hike: Dickson Falls (Fundy Park)." },
             { time: "14:00", text: "Arrive RDL. Check-in Pet Friendly Hotel." },
             { time: "16:00", text: "Parc de la Pointe. Long walk with Finn." },
             { time: "19:00", text: "Sunset dinner by the St. Lawrence River." }
          ],
          images: ["https://images.unsplash.com/photo-1518126084048-8df098492021?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1623942080373-c44402621b19?q=80&w=400&auto=format&fit=crop"]
        },
        { day: 8, date: "Sat, Aug 22", title: "Whales & Home", route: "RDL ‚Üí Ottawa", color: "bg-slate-700",
          schedule: [
             { time: "09:30", text: "AML Whale Cruise. üêã Belugas. (Finn in hotel)." },
             { time: "13:00", text: "Lunch & Walk Finn." },
             { time: "14:00", text: "Drive Home (6h)." },
             { time: "20:00", text: "Arrive Ottawa." }
          ],
          images: ["https://images.unsplash.com/photo-1568430462989-44163eb1752f?q=80&w=400&auto=format&fit=crop", "https://images.unsplash.com/photo-1596282247385-0552b75a1d7c?q=80&w=400&auto=format&fit=crop"]
        }
    ];

    const attractions = [
        { title: 'Mary\'s Point', cat: 'hidden', loc: 'Shepody Bay', img: 'https://images.unsplash.com/photo-1452570053594-1b985d6ea890?q=80&w=400&auto=format&fit=crop', desc: 'Massive Sandpiper migration.' },
        { title: 'Kamouraska', cat: 'hidden', loc: 'Quebec', img: 'https://images.unsplash.com/photo-1621882414734-7221e106950e?q=80&w=400&auto=format&fit=crop', desc: 'Fairytale village lunch.' },
        { title: 'Hartland Bridge', cat: 'hidden', loc: 'NB', img: 'https://images.unsplash.com/photo-1443632864897-14973fa006cf?q=80&w=400&auto=format&fit=crop', desc: 'Longest covered bridge.' },
        { title: 'French River', cat: 'hidden', loc: 'PEI', img: 'https://images.unsplash.com/photo-1518117621415-468205c6c21e?q=80&w=400&auto=format&fit=crop', desc: 'Iconic fishing village.' },
        { title: 'Victoria-by-the-Sea', cat: 'hidden', loc: 'PEI', img: 'https://images.unsplash.com/photo-1507525428034-b723cf961d3e?q=80&w=400&auto=format&fit=crop', desc: 'Charming seaside village.' },
        { title: 'Beluga Whales', cat: 'mammals', loc: 'Rivi√®re-du-Loup', img: 'https://images.unsplash.com/photo-1568430462989-44163eb1752f?q=80&w=400&auto=format&fit=crop', desc: 'St. Lawrence giants.' },
        { title: 'Red Foxes', cat: 'mammals', loc: 'Stanhope', img: 'https://images.unsplash.com/photo-1474511320723-9a56873867b5?q=80&w=400&auto=format&fit=crop', desc: 'Roaming the dunes.' },
        { title: 'Piping Plovers', cat: 'birds', loc: 'Greenwich', img: 'https://images.unsplash.com/photo-1552353617-3913788a1834?q=80&w=400&auto=format&fit=crop', desc: 'Endangered shorebirds.' },
        { title: 'Sackville Waterfowl', cat: 'birds', loc: 'NB', img: 'https://images.unsplash.com/photo-1480044965905-02098d419e96?q=80&w=400&auto=format&fit=crop', desc: 'Dog-friendly boardwalks.' },
        { title: 'Bison Herd', cat: 'mammals', loc: 'Buffaloland', img: 'https://images.unsplash.com/photo-1505238240580-c0812e12822a?q=80&w=400&auto=format&fit=crop', desc: 'Provincial park herd.' },
        { title: 'Peregrine Falcons', cat: 'birds', loc: 'Hopewell', img: 'https://images.unsplash.com/photo-1619623696803-b097b667232c?q=80&w=400&auto=format&fit=crop', desc: 'Nesting on cliffs.' },
        { title: 'Grey Seals', cat: 'mammals', loc: 'Point Prim', img: 'https://images.unsplash.com/photo-1563200767-17b070921869?q=80&w=400&auto=format&fit=crop', desc: 'Hauled out on rocks at low tide.' },
        { title: 'Cape Tryon', cat: 'hidden', loc: 'French River', img: 'https://images.unsplash.com/photo-1621882414734-7221e106950e?q=80&w=400&auto=format&fit=crop', desc: 'Massive red cliffs.' }
    ];

    const photographers = [
       { name: "Michaela Bell", style: "Natural / Documentary", img: "https://images.unsplash.com/photo-1515934751635-c81c6bc9a2d8?q=80&w=400&auto=format&fit=crop" },
       { name: "Diego Moura", style: "Storytelling", img: "https://images.unsplash.com/photo-1519741497674-611481863552?q=80&w=400&auto=format&fit=crop" }
    ];

    const WISHLIST_ITEMS = [
      { id: 'wish-engage', label: 'Engagement photo shoot', emoji: 'üì∏' },
      { id: 'wish-camping', label: 'Camping at Stanhope', emoji: '‚õ∫' },
      { id: 'wish-bridge', label: 'Confederation Bridge', emoji: 'üåâ' },
      { id: 'wish-whales', label: 'Beluga Whales', emoji: 'üêã' }
    ];

    // --- RENDERERS ---
    function renderTimeline() {
        const container = document.getElementById('timeline-container');
        if(!container) return;
        let html = '<div class="absolute left-[26px] top-4 bottom-4 w-0.5 bg-slate-200"></div>';
        
        itineraryData.forEach((day, index) => {
            let scheduleHtml = day.schedule.map(s => `
                <li class="flex items-start">
                    <span class="font-bold w-14 text-slate-400 text-xs shrink-0">${s.time}</span>
                    <span class="text-sm text-slate-700">${s.text}</span>
                </li>
            `).join('');

            let imagesHtml = day.images.map(url => `
                <div class="h-24 rounded-lg overflow-hidden bg-slate-100">
                    <img src="${url}" class="w-full h-full object-cover" onerror="this.style.display='none'">
                </div>
            `).join('');

            html += `
                <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden relative z-10" ${index===0 ? 'open' : ''}>
                    <summary class="flex items-center p-4 bg-slate-50 cursor-pointer list-none hover:bg-slate-100 transition">
                        <div class="${day.color} text-white font-bold w-10 h-10 rounded-lg flex items-center justify-center text-lg shadow-md shrink-0 z-10">${day.day}</div>
                        <div class="ml-4 flex-grow">
                            <h3 class="font-bold text-slate-800">${day.date}: ${day.title}</h3>
                            <p class="text-xs text-slate-500">${day.route}</p>
                        </div>
                        <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                    </summary>
                    <div class="p-5 border-t border-slate-100">
                        <ul class="space-y-3 mb-4">${scheduleHtml}</ul>
                        <div class="grid grid-cols-2 gap-2">${imagesHtml}</div>
                    </div>
                </details>
            `;
        });
        container.innerHTML = html;
    }

    function renderAttractions(filter) {
        const grid = document.getElementById('attraction-grid');
        grid.innerHTML = '';
        attractions.forEach(item => {
            if(filter !== 'all' && item.cat !== filter) return;
            const card = document.createElement('div');
            card.className = "bg-white rounded-xl shadow-md border border-slate-100 overflow-hidden group hover:-translate-y-1 transition";
            card.innerHTML = `
                <div class="h-40 overflow-hidden relative">
                    <img src="${item.img}" class="w-full h-full object-cover group-hover:scale-110 transition duration-500" onerror="this.parentNode.classList.add('img-fallback'); this.style.display='none'; this.parentNode.innerText='Image Unavailable'">
                    <div class="absolute top-2 right-2 bg-slate-800/80 text-white text-[10px] font-bold px-2 py-1 rounded uppercase">${item.cat}</div>
                </div>
                <div class="p-4">
                    <h3 class="font-bold text-slate-800">${item.title}</h3>
                    <p class="text-xs font-bold text-slate-400 uppercase mb-2">üìç ${item.loc}</p>
                    <p class="text-xs text-slate-600">${item.desc}</p>
                </div>
            `;
            grid.appendChild(card);
        });
    }

    function renderPhotographers() {
        const grid = document.getElementById('photo-grid');
        grid.innerHTML = '';
        photographers.forEach(p => {
            const card = document.createElement('div');
            card.className = "bg-white rounded-xl shadow-md border border-slate-100 overflow-hidden p-4";
            card.innerHTML = `
                <div class="h-40 rounded-lg overflow-hidden mb-3 bg-slate-100">
                    <img src="${p.img}" class="w-full h-full object-cover">
                </div>
                <h3 class="font-bold text-slate-800">${p.name}</h3>
                <p class="text-xs text-slate-500">${p.style}</p>
            `;
            grid.appendChild(card);
        });
    }

    function initWishlist() {
        const host = document.getElementById('wishlist');
        host.innerHTML = '';
        WISHLIST_ITEMS.forEach(item => {
            const card = document.createElement('div');
            card.className = 'flex items-center gap-3 bg-slate-50 border border-slate-200 rounded-xl p-4';
            card.innerHTML = `<span class="text-2xl">${item.emoji}</span><span class="font-bold text-slate-700">${item.label}</span>`;
            host.appendChild(card);
        });
    }

    // --- MAP ---
    let map;
    function initMap() {
        if(map) return;
        map = L.map('map', {scrollWheelZoom:false}).setView([46.8, -67], 6);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', { attribution: '&copy; OpenStreetMap', maxZoom: 19 }).addTo(map);

        const pts = { ottawa:[45.4,-75.7], trapper:[46.7,-67.6], stanhope:[46.4,-63.1], alma:[45.6,-64.9], rdl:[47.8,-69.5] };
        
        // Polylines
        L.polyline([pts.ottawa, [46.8,-71.2], pts.trapper], {color:'#db2777', weight:4}).addTo(map);
        L.polyline([pts.trapper, pts.stanhope], {color:'#f59e0b', weight:4}).addTo(map);
        L.polyline([pts.stanhope, pts.alma, pts.rdl], {color:'#10b981', weight:4}).addTo(map);
        L.polyline([pts.rdl, pts.ottawa], {color:'#3b82f6', weight:4, dashArray:'5,5'}).addTo(map);

        // Markers
        Object.entries(pts).forEach(([k,v]) => L.marker(v).addTo(map).bindPopup(k.toUpperCase()));
    }

    // --- BUDGET ---
    let budgetChart;
    function updateBudget() {
        const accom = parseFloat(document.getElementById('input-accom').value);
        const food = parseFloat(document.getElementById('input-food').value);
        const gas = parseFloat(document.getElementById('input-gas').value);
        
        const fixed = 116 + 100 + 200; // Cabin + Camp + Whales
        const varAccom = 4 * accom;
        const dist = 2850; 
        const fuel = Math.round((dist/100)*9.5*gas);
        const bridge = 50;
        const total = fixed + varAccom + fuel + bridge + (food*2*8);

        document.getElementById('total-cost').innerText = '$' + total.toLocaleString();
        document.getElementById('val-accom').innerText = accom;
        document.getElementById('val-food').innerText = food;
        document.getElementById('val-gas').innerText = gas;

        if(budgetChart) {
            budgetChart.data.datasets[0].data = [fuel, fixed+varAccom, food*2*8, bridge+200];
            budgetChart.update();
        }
    }

    function initBudget() {
        const ctx = document.getElementById('budgetChart').getContext('2d');
        budgetChart = new Chart(ctx, {
            type: 'doughnut',
            data: { labels: ['Gas', 'Stay', 'Food', 'Fun'], datasets:[{ data:[1,1,1,1], backgroundColor:['#3b82f6','#f59e0b','#10b981','#6366f1'] }] },
            options: { responsive:true, cutout:'70%', plugins:{legend:{position:'bottom'}} }
        });
        ['accom','food','gas'].forEach(id => document.getElementById('input-'+id).addEventListener('input', updateBudget));
        updateBudget();
    }

    // --- CORE ---
    function checkPassword() {
        if(document.getElementById('password-input').value.toLowerCase() === 'maritime') {
            document.getElementById('login-overlay').style.display='none';
            document.getElementById('app-container').classList.remove('hidden');
            setTimeout(() => { 
                initMap(); 
                initBudget(); 
                renderTimeline(); 
                renderAttractions('all'); 
                renderPhotographers();
                initWishlist(); 
            }, 100);
        } else {
            document.getElementById('error-msg').classList.remove('hidden');
        }
    }
    document.getElementById('password-input').addEventListener('keypress', e => e.key==='Enter' && checkPassword());

    window.switchTab = (id) => {
        document.querySelectorAll('section[id^="content-"]').forEach(el => el.classList.add('hidden'));
        document.querySelectorAll('button[id^="tab-"]').forEach(el => el.className = 'tab-inactive py-5 px-6 transition-all flex items-center gap-2');
        document.getElementById(`content-${id}`).classList.remove('hidden');
        document.getElementById(`tab-${id}`).className = 'tab-active py-5 px-6 transition-all flex items-center gap-2';
        if(id === 'route') setTimeout(() => map.invalidateSize(), 100);
    }
  </script>
</body>
</html>
