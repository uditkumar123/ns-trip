<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maritime Loop: Ottawa, PEI & NS Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .tab-active { border-bottom: 2px solid #0891b2; color: #0e7490; font-weight: 600; }
        .tab-inactive { color: #64748b; }
        .tab-inactive:hover { color: #334155; }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            height: 350px;
            max-height: 400px;
        }
        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }

        /* Map Specific Container */
        .map-wrapper {
            position: relative;
            width: 100%;
            height: 400px;
            background-color: #f0f9ff;
            border-radius: 1rem;
            border: 1px solid #cffafe;
            overflow: hidden;
            margin-bottom: 2rem;
        }
        canvas#routeMapCanvas {
            width: 100%;
            height: 100%;
            display: block;
        }

        .timeline-line {
            position: absolute;
            left: 50%;
            transform: translateX(-50%);
            width: 4px;
            height: 100%;
            background-color: #e2e8f0;
            z-index: 0;
        }

        /* Login Overlay */
        #login-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(15, 23, 42, 0.95);
            z-index: 9999;
            display: flex;
            justify-content: center;
            align-items: center;
            backdrop-filter: blur(5px);
        }
    </style>
</head>
<body class="text-slate-800">

    <!-- PASSWORD OVERLAY -->
    <div id="login-overlay">
        <div class="bg-white p-8 rounded-xl shadow-2xl max-w-sm w-full text-center">
            <div class="text-4xl mb-4">üîí</div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Trip Planner Locked</h2>
            <p class="text-sm text-slate-500 mb-6">Enter password to view itinerary.</p>
            
            <input type="password" id="password-input" placeholder="Enter password" 
                   class="w-full p-3 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-cyan-500 outline-none transition">
            
            <button onclick="checkPassword()" 
                    class="w-full bg-cyan-700 text-white font-bold py-3 rounded-lg hover:bg-cyan-800 transition">
                Unlock Plan
            </button>
            <p id="error-msg" class="text-red-500 text-xs mt-3 hidden">Incorrect password.</p>
        </div>
    </div>

    <!-- MAIN APP CONTAINER (Hidden initially) -->
    <div id="app-container" class="hidden max-w-6xl mx-auto min-h-screen flex flex-col bg-white shadow-xl my-0 md:my-8 rounded-lg overflow-hidden">
        
        <!-- Header -->
        <header class="bg-cyan-900 text-white p-8">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                <div>
                    <h1 class="text-3xl md:text-4xl font-bold tracking-tight">The Maritime Loop</h1>
                    <p class="text-cyan-200 mt-2 text-lg">Ottawa &#8594; PEI &#8594; Nova Scotia &#8594; Ottawa</p>
                </div>
                <div class="mt-4 md:mt-0 bg-cyan-800 px-4 py-2 rounded-lg border border-cyan-700">
                    <span class="block text-sm text-cyan-300 uppercase tracking-wide font-semibold">Pre-Wedding Relaxer</span>
                    <div class="flex items-center space-x-4 mt-1">
                        <span class="text-white font-bold">&#128101; 6 Travelers</span>
                        <span class="text-white font-bold">&#128663; ~3,200km Loop</span>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white border-b border-slate-200 sticky top-0 z-50">
            <div class="flex overflow-x-auto px-4 md:px-8 space-x-8">
                <button onclick="switchTab('route')" id="tab-route" class="tab-active py-4 px-2 whitespace-nowrap transition-colors">
                    &#128506; The Loop (Route)
                </button>
                <button onclick="switchTab('budget')" id="tab-budget" class="tab-inactive py-4 px-2 whitespace-nowrap transition-colors">
                    &#128176; Smart Budget
                </button>
                <button onclick="switchTab('attractions')" id="tab-attractions" class="tab-inactive py-4 px-2 whitespace-nowrap transition-colors">
                    &#127754; Attractions (PEI + NS)
                </button>
                <button onclick="switchTab('logistics')" id="tab-logistics" class="tab-inactive py-4 px-2 whitespace-nowrap transition-colors">
                    &#128295; Logistics & Timing
                </button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-grow p-4 md:p-8 bg-slate-50">

            <!-- TAB: ROUTE -->
            <section id="content-route" class="space-y-8 animate-fade-in">
                <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                    <h2 class="text-2xl font-bold text-slate-800 mb-2">The "Bridge In, Ferry Out" Strategy</h2>
                    <p class="text-slate-600 mb-6">
                        Optimized for family visits and beach days. Enter via Bridge, Exit via Ferry.
                    </p>

                    <!-- Schematic Map Canvas -->
                    <div class="map-wrapper">
                        <canvas id="routeMapCanvas"></canvas>
                        <div class="absolute bottom-4 left-4 bg-white/90 p-3 rounded-lg shadow-sm border border-slate-200 text-xs pointer-events-none">
                            <div class="flex items-center mb-1"><span class="w-3 h-3 rounded-full bg-slate-800 mr-2"></span> Stops</div>
                            <div class="flex items-center mb-1"><span class="w-8 h-1 bg-cyan-600 mr-2"></span> Drive</div>
                            <div class="flex items-center"><span class="w-8 h-1 border-b-2 border-dashed border-cyan-600 mr-2"></span> Ferry/Bridge</div>
                        </div>
                    </div>
                    
                    <!-- Interactive Timeline -->
                    <div class="relative py-8">
                        <div class="hidden md:block timeline-line bg-slate-200"></div>

                        <!-- Stop 1 -->
                        <div class="flex flex-col md:flex-row items-center mb-12 relative z-10">
                            <div class="w-full md:w-1/2 md:pr-8 text-center md:text-right mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-cyan-900">Start: Ottawa, ON</h3>
                                <p class="text-slate-500">Day 1: 07:00 AM</p>
                                <p class="text-sm text-slate-600 mt-1">Drive 7 hours. Overnight in <strong>Edmundston, NB</strong>.</p>
                            </div>
                            <div class="w-8 h-8 rounded-full bg-cyan-600 border-4 border-white shadow flex items-center justify-center text-white text-xs font-bold">1</div>
                            <div class="w-full md:w-1/2 md:pl-8 hidden md:block"></div>
                        </div>

                        <!-- Stop 2: PEI Arrival -->
                        <div class="flex flex-col md:flex-row items-center mb-12 relative z-10">
                            <div class="w-full md:w-1/2 md:pr-8 hidden md:block"></div>
                            <div class="w-8 h-8 rounded-full bg-amber-400 border-4 border-white shadow flex items-center justify-center text-white text-xs font-bold">2</div>
                            <div class="w-full md:w-1/2 md:pl-8 text-center md:text-left mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-slate-800">PEI Arrival & Family</h3>
                                <p class="text-slate-500">Days 2-4 (PEI Leg)</p>
                                <p class="text-sm text-slate-600 mt-1">Cross Confederation Bridge. Visit <strong class="text-cyan-700">Udit's Aunt</strong>. Hit Brackley Beach & Basin Head. See the Anne Musical.</p>
                            </div>
                        </div>

                        <!-- Stop 3: Ferry -->
                        <div class="flex flex-col md:flex-row items-center mb-12 relative z-10">
                            <div class="w-full md:w-1/2 md:pr-8 text-center md:text-right mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-slate-800">Ferry to Nova Scotia</h3>
                                <p class="text-slate-500">Day 5: Morning</p>
                                <p class="text-sm text-slate-600 mt-1">Ferry from Wood Islands. Head to Cape Breton or Halifax.</p>
                            </div>
                            <div class="w-8 h-8 rounded-full bg-indigo-600 border-4 border-white shadow flex items-center justify-center text-white text-xs font-bold">3</div>
                            <div class="w-full md:w-1/2 md:pl-8 hidden md:block"></div>
                        </div>

                        <!-- Stop 4: NS -->
                        <div class="flex flex-col md:flex-row items-center relative z-10">
                            <div class="w-full md:w-1/2 md:pr-8 hidden md:block"></div>
                            <div class="w-8 h-8 rounded-full bg-cyan-600 border-4 border-white shadow flex items-center justify-center text-white text-xs font-bold">4</div>
                            <div class="w-full md:w-1/2 md:pl-8 text-center md:text-left mb-4 md:mb-0">
                                <h3 class="text-xl font-bold text-cyan-900">Nova Scotia Leg</h3>
                                <p class="text-slate-500">Days 5-8</p>
                                <p class="text-sm text-slate-600 mt-1">Halifax Waterfront & Peggy's Cove. Drive home Day 9.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: BUDGET -->
            <section id="content-budget" class="hidden space-y-8 animate-fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Controls -->
                    <div class="lg:col-span-1 bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">Budget Parameters</h2>
                        <p class="text-sm text-slate-500 mb-6">Adjust for 6 people in August (High Season).</p>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Trip Duration (Days): <span id="val-days" class="text-cyan-600">8</span></label>
                                <input type="range" id="input-days" min="5" max="14" value="8" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Accom. per Night (Total): $<span id="val-accom" class="text-cyan-600">400</span></label>
                                <input type="range" id="input-accom" min="150" max="800" step="50" value="400" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Food per Person/Day: $<span id="val-food" class="text-cyan-600">65</span></label>
                                <input type="range" id="input-food" min="30" max="150" step="5" value="65" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2">Gas Price (per L): $<span id="val-gas" class="text-cyan-600">1.65</span></label>
                                <input type="range" id="input-gas" min="1.30" max="2.20" step="0.05" value="1.65" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-cyan-600">
                            </div>
                        </div>

                        <div class="mt-8 pt-6 border-t border-slate-100">
                            <div class="flex justify-between items-end mb-2">
                                <span class="text-slate-600 font-medium">Total Cost</span>
                                <span id="total-cost" class="text-2xl font-bold text-slate-800">$0</span>
                            </div>
                            <div class="flex justify-between items-end">
                                <span class="text-slate-500 text-sm">Per Person (6 pax)</span>
                                <span id="per-person-cost" class="text-lg font-bold text-cyan-600">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Visualization -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-slate-100 flex flex-col justify-center">
                        <div class="mb-4">
                            <h2 class="text-xl font-bold text-slate-800">Cost Breakdown</h2>
                            <p class="text-slate-500 text-sm">Includes Bridge/Ferry estimate (~$150 total for minivan).</p>
                        </div>
                        
                        <div class="chart-container">
                            <canvas id="budgetChart"></canvas>
                        </div>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mt-6 text-center">
                            <div class="p-3 bg-slate-50 rounded-lg">
                                <div class="text-xs text-slate-500 uppercase">Transport</div>
                                <div id="stat-transport" class="font-bold text-slate-700">-</div>
                            </div>
                            <div class="p-3 bg-slate-50 rounded-lg">
                                <div class="text-xs text-slate-500 uppercase">Accommodation</div>
                                <div id="stat-accom" class="font-bold text-slate-700">-</div>
                            </div>
                            <div class="p-3 bg-slate-50 rounded-lg">
                                <div class="text-xs text-slate-500 uppercase">Food</div>
                                <div id="stat-food" class="font-bold text-slate-700">-</div>
                            </div>
                            <div class="p-3 bg-slate-50 rounded-lg">
                                <div class="text-xs text-slate-500 uppercase">Fun & Ferry</div>
                                <div id="stat-fun" class="font-bold text-slate-700">-</div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: ATTRACTIONS -->
            <section id="content-attractions" class="hidden space-y-8 animate-fade-in">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">Must-See Spots</h2>
                        <p class="text-slate-600">Udit's Family, Singing Sands & Ocean Rocks.</p>
                    </div>
                    <div class="flex space-x-2 mt-4 md:mt-0 flex-wrap gap-2">
                        <button onclick="filterAttractions('all')" class="px-3 py-1 text-sm bg-slate-200 hover:bg-slate-300 rounded-full text-slate-700 transition">All</button>
                        <button onclick="filterAttractions('pei')" class="px-3 py-1 text-sm bg-amber-100 hover:bg-amber-200 rounded-full text-amber-800 transition font-bold">Prince Edward Island</button>
                        <button onclick="filterAttractions('ns-nature')" class="px-3 py-1 text-sm bg-green-100 hover:bg-green-200 rounded-full text-green-700 transition">NS Nature</button>
                        <button onclick="filterAttractions('ns-culture')" class="px-3 py-1 text-sm bg-blue-100 hover:bg-blue-200 rounded-full text-blue-700 transition">NS Culture</button>
                    </div>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" id="attraction-grid">
                    <!-- Cards injected by JS -->
                </div>
            </section>

            <!-- TAB: LOGISTICS -->
            <section id="content-logistics" class="hidden space-y-8 animate-fade-in">
                
                <!-- Strategic Timing Section (August Recommendation) -->
                <div class="bg-gradient-to-r from-teal-800 to-teal-600 rounded-xl shadow-lg p-1">
                    <div class="bg-white rounded-lg p-6">
                        <div class="flex items-center mb-6">
                            <span class="text-3xl mr-3">üíç</span>
                            <div>
                                <h3 class="text-xl font-bold text-slate-800">The "Pre-Wedding" Relaxer Strategy</h3>
                                <p class="text-sm text-slate-500">Optimized for an October Wedding Timeline</p>
                            </div>
                        </div>

                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            
                            <!-- The Recommendation -->
                            <div>
                                <div class="flex items-center justify-between mb-2">
                                    <h4 class="text-lg font-bold text-teal-700">Target: Civic Holiday / Natal Day</h4>
                                    <span class="bg-teal-100 text-teal-800 text-xs font-bold px-2 py-1 rounded uppercase">Aug 1‚Äì9, 2026</span>
                                </div>
                                <div class="bg-slate-50 p-4 rounded-lg border border-slate-200 mb-4">
                                    <p class="font-bold text-slate-800 mb-1">Monday, August 3rd</p>
                                    <p class="text-xs text-slate-500">ON: Civic Holiday | NS: Natal Day</p>
                                </div>
                                <ul class="space-y-3 text-sm text-slate-700">
                                    <li class="flex items-start">
                                        <span class="text-teal-500 font-bold mr-2">‚úì</span> 
                                        <strong>The Anne Musical:</strong> Confirmed in season (June-Sept) at the Confederation Centre!
                                    </li>
                                    <li class="flex items-start">
                                        <span class="text-teal-500 font-bold mr-2">‚úì</span> 
                                        <strong>Beach Weather:</strong> Perfect for Brackley Beach & Basin Head swimming.
                                    </li>
                                </ul>
                            </div>

                            <!-- Trade-offs -->
                            <div class="border-l-0 md:border-l border-slate-200 md:pl-8">
                                <h4 class="text-sm font-bold text-slate-400 uppercase tracking-wide mb-4">August Logistics</h4>
                                
                                <div class="space-y-4">
                                    <div class="flex items-start">
                                        <span class="text-amber-500 text-xl mr-3">üí∞</span>
                                        <div>
                                            <strong class="block text-slate-800 text-sm">Peak Pricing</strong>
                                            <p class="text-xs text-slate-500">August is expensive. PEI rentals near the beach book out by March.</p>
                                        </div>
                                    </div>

                                    <div class="flex items-start">
                                        <span class="text-red-500 text-xl mr-3">‚õ¥Ô∏è</span>
                                        <div>
                                            <strong class="block text-slate-800 text-sm">Ferry Booking Mandatory</strong>
                                            <p class="text-xs text-slate-500">The Ferry from PEI to NS saves 3 hours of driving but fills up. Book your slot for Day 4/5 as soon as dates are set.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- PEI Logistics -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                         <div class="flex items-center mb-4">
                            <span class="text-2xl mr-3">üåâ</span>
                            <h3 class="text-xl font-bold text-slate-800">Bridge vs. Ferry</h3>
                        </div>
                        <ul class="space-y-4">
                            <li class="p-3 bg-slate-50 rounded-lg">
                                <strong class="block text-slate-800">Confederation Bridge (Entry)</strong>
                                <p class="text-sm text-slate-600 mt-1">Entering PEI is free. Leaving costs ~$50/car. We recommend <strong>entering</strong> this way from New Brunswick.</p>
                            </li>
                            <li class="p-3 bg-blue-50 rounded-lg border-l-4 border-blue-500">
                                <strong class="block text-blue-900">Wood Islands Ferry (Exit)</strong>
                                <p class="text-sm text-slate-700 mt-1">Leaving PEI towards Nova Scotia. Costs ~$90 for a minivan + passengers, but lands you near the scenic Cabot Trail route, saving boring highway miles.</p>
                            </li>
                        </ul>
                    </div>

                    <!-- Accommodation -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-100">
                        <h3 class="text-xl font-bold text-slate-800 mb-4">Housing 6 People</h3>
                        <div class="space-y-3">
                            <div class="p-3 border border-slate-200 rounded-lg">
                                <div class="font-bold text-slate-800">PEI Cottages</div>
                                <p class="text-sm text-slate-600 mt-1">Look in Cavendish or North Rustico. Weekly rentals (Sat-Sat) are common in August, so finding 2-3 nights might be harder. Look for "Cottage Courts".</p>
                            </div>
                            <div class="p-3 border border-slate-200 rounded-lg">
                                <div class="font-bold text-slate-800">Halifax/NS</div>
                                <p class="text-sm text-slate-600 mt-1">Stick to Airbnbs/VRBOs for space. University dorms (Dalhousie) are a great backup budget option.</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="bg-slate-100 p-6 text-center text-slate-500 text-sm border-t border-slate-200">
            <p>Generated Trip Planner for 6 Travelers. Prices are estimates in CAD based on 2025/26 rates.</p>
        </footer>
    </div>

    <script>
        // --- DATA & STATE ---
        const attractionsData = [
            {
                title: "Udit's Aunt's House",
                category: "pei",
                location: "Prince Edward Island",
                description: "Family visit! The highlight of the PEI leg. Time for tea and catching up.",
                icon: "üè°"
            },
            {
                title: "Anne of Green Gables Musical",
                category: "pei",
                location: "Confederation Centre",
                description: "The world's longest-running annual musical. Runs June-Sept, so it is perfectly in season for your trip!",
                icon: "üé≠"
            },
            {
                title: "Brackley Beach",
                category: "pei",
                location: "PEI National Park",
                description: "Famous for massive dunes. A bit quieter than Cavendish but just as beautiful. Great for sunset walks.",
                icon: "üèñÔ∏è"
            },
            {
                title: "Basin Head (Singing Sands)",
                category: "pei",
                location: "Eastern PEI (Souris)",
                description: "The sand actually squeaks when you walk! Jumping off the bridge into the 'run' is a local rite of passage.",
                icon: "üé∂"
            },
            {
                title: "Charlottetown Waterfront",
                category: "pei",
                location: "Charlottetown, PEI",
                description: "Walk Victoria Row, see the tall ships, and definitely get **Cows Ice Cream** on the Wharf.",
                icon: "üç¶"
            },
            {
                title: "Hopewell Rocks",
                category: "ns-nature",
                location: "New Brunswick (En route)",
                description: "Walk on the ocean floor at low tide. Best stop before the Confederation Bridge.",
                icon: "ü™®"
            },
            {
                title: "Peggy's Cove",
                category: "ns-nature",
                location: "Nova Scotia",
                description: "The iconic lighthouse. 45 mins from Halifax. Visit early to beat the cruise ship buses.",
                icon: "üî¶"
            },
            {
                title: "Halifax Waterfront",
                category: "ns-culture",
                location: "Halifax, NS",
                description: "Walk the boardwalk, Maritime Museum, and ... yes, more Cows Ice Cream.",
                icon: "üèôÔ∏è"
            },
            {
                title: "Lunenburg",
                category: "ns-culture",
                location: "South Shore, NS",
                description: "UNESCO World Heritage site. Colorful buildings and the Bluenose II.",
                icon: "‚õµ"
            }
        ];

        let budgetChartInstance = null;

        // --- PASSWORD LOGIC ---
        function checkPassword() {
            const input = document.getElementById('password-input').value;
            const errorMsg = document.getElementById('error-msg');
            const overlay = document.getElementById('login-overlay');
            const app = document.getElementById('app-container');

            if (input.toLowerCase() === 'maritime') {
                overlay.style.opacity = '0';
                overlay.style.transition = 'opacity 0.5s ease';
                setTimeout(() => {
                    overlay.style.display = 'none';
                    app.classList.remove('hidden');
                    // Trigger map resize once visible
                    window.dispatchEvent(new Event('resize'));
                }, 500);
            } else {
                errorMsg.classList.remove('hidden');
            }
        }
        // Allow Enter key
        document.getElementById('password-input').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') checkPassword();
        });


        // --- MAP LOGIC ---
        function initMap() {
            const canvas = document.getElementById('routeMapCanvas');
            const ctx = canvas.getContext('2d');
            
            const locations = {
                ottawa: { x: 0.1, y: 0.6, label: "Ottawa" },
                qc: { x: 0.35, y: 0.5, label: "Quebec City" },
                edmundston: { x: 0.5, y: 0.55, label: "Edmundston" },
                moncton: { x: 0.65, y: 0.65, label: "Moncton" },
                pei: { x: 0.75, y: 0.35, label: "PEI (Aunt!)" }, // Updated label
                ferry: { x: 0.82, y: 0.45, label: "Ferry" },
                halifax: { x: 0.85, y: 0.75, label: "Halifax" }
            };

            function resize() {
                const rect = canvas.parentElement.getBoundingClientRect();
                canvas.width = rect.width;
                canvas.height = rect.height;
                draw();
            }

            function draw() {
                const w = canvas.width;
                const h = canvas.height;
                
                ctx.fillStyle = '#ecfeff';
                ctx.fillRect(0, 0, w, h);

                const getXY = (loc) => ({ x: loc.x * w, y: loc.y * h });

                ctx.lineWidth = 4;
                ctx.lineCap = 'round';
                ctx.lineJoin = 'round';

                const ott = getXY(locations.ottawa);
                const qc = getXY(locations.qc);
                const edm = getXY(locations.edmundston);
                const mon = getXY(locations.moncton);
                const pei = getXY(locations.pei);
                const hal = getXY(locations.halifax);

                // 1. Ottawa -> Moncton
                ctx.strokeStyle = '#0891b2'; 
                ctx.setLineDash([]);
                ctx.beginPath();
                ctx.moveTo(ott.x, ott.y);
                ctx.lineTo(qc.x, qc.y);
                ctx.lineTo(edm.x, edm.y);
                ctx.lineTo(mon.x, mon.y);
                ctx.stroke();

                // 2. Moncton -> PEI
                ctx.beginPath();
                ctx.moveTo(mon.x, mon.y);
                ctx.lineTo(mon.x, mon.y - (h * 0.15));
                ctx.lineTo(pei.x, pei.y);
                ctx.stroke();

                // 3. PEI -> Halifax (Ferry)
                ctx.strokeStyle = '#f59e0b';
                ctx.setLineDash([10, 10]);
                ctx.beginPath();
                ctx.moveTo(pei.x, pei.y);
                ctx.quadraticCurveTo(pei.x + 50, pei.y + 50, hal.x, hal.y);
                ctx.stroke();

                // 4. Return
                ctx.strokeStyle = '#94a3b8';
                ctx.setLineDash([5, 5]);
                ctx.beginPath();
                ctx.moveTo(hal.x, hal.y);
                ctx.lineTo(mon.x, mon.y);
                ctx.stroke();

                // Points
                ctx.setLineDash([]);
                Object.values(locations).forEach(loc => {
                    if (loc.label === 'Ferry') return;
                    const p = getXY(loc);
                    
                    ctx.beginPath();
                    ctx.arc(p.x, p.y, 8, 0, Math.PI * 2);
                    ctx.fillStyle = loc.label.includes('Aunt') ? '#fbbf24' : '#fff'; // Gold for Aunt
                    ctx.fill();
                    ctx.strokeStyle = '#1e293b';
                    ctx.lineWidth = 3;
                    ctx.stroke();

                    ctx.font = 'bold 12px Inter, sans-serif';
                    ctx.fillStyle = '#334155';
                    ctx.textAlign = 'center';
                    ctx.fillText(loc.label, p.x, p.y - 15);
                });
                
                // Labels
                ctx.fillStyle = '#0e7490';
                ctx.font = 'italic 11px Inter, sans-serif';
                ctx.fillText("Confederation Bridge", mon.x + (w*0.02), mon.y - (h*0.1));
                
                ctx.fillStyle = '#d97706';
                ctx.fillText("Ferry", pei.x + (w*0.05), pei.y + (h*0.1));
            }

            window.addEventListener('resize', resize);
            // Initial draw attempt
            if(canvas.width > 0) draw();
        }

        // --- CORE FUNCTIONS ---
        function switchTab(tabId) {
            ['route', 'budget', 'attractions', 'logistics'].forEach(id => {
                document.getElementById(`content-${id}`).classList.add('hidden');
                document.getElementById(`tab-${id}`).classList.remove('tab-active');
                document.getElementById(`tab-${id}`).classList.add('tab-inactive');
            });
            document.getElementById(`content-${tabId}`).classList.remove('hidden');
            const activeTab = document.getElementById(`tab-${tabId}`);
            activeTab.classList.add('tab-active');
            activeTab.classList.remove('tab-inactive');
            if(tabId === 'budget' && budgetChartInstance) { budgetChartInstance.resize(); }
            if(tabId === 'route') { window.dispatchEvent(new Event('resize')); }
        }

        // --- ATTRACTIONS RENDERER ---
        function renderAttractions(filter) {
            const grid = document.getElementById('attraction-grid');
            grid.innerHTML = '';
            
            attractionsData.forEach(item => {
                // Special handling for Aunt (always show in PEI or All)
                if (filter !== 'all' && filter === 'pei' && item.title.includes('Aunt')) {
                    // fall through
                } else if (filter !== 'all' && item.category !== filter) return;

                const card = document.createElement('div');
                card.className = "bg-white rounded-lg shadow-sm border border-slate-200 overflow-hidden hover:shadow-md transition-shadow";
                
                let colors = {
                    'pei': 'text-amber-800 bg-amber-50',
                    'ns-nature': 'text-green-600 bg-green-50',
                    'ns-culture': 'text-blue-600 bg-blue-50'
                };
                // Custom override for Aunt
                let tagColor = item.title.includes('Aunt') ? 'text-purple-700 bg-purple-100' : (colors[item.category] || 'text-slate-600 bg-slate-100');
                let tagLabel = item.title.includes('Aunt') ? 'Family' : (item.category === 'pei' ? 'PEI' : 'Nova Scotia');

                card.innerHTML = `
                    <div class="h-2 bg-gradient-to-r from-cyan-500 to-amber-400"></div>
                    <div class="p-6">
                        <div class="flex justify-between items-start mb-4">
                            <div class="text-4xl">${item.icon}</div>
                            <span class="text-xs font-bold px-2 py-1 rounded uppercase tracking-wide ${tagColor}">${tagLabel}</span>
                        </div>
                        <h3 class="text-lg font-bold text-slate-800 mb-1">${item.title}</h3>
                        <p class="text-xs text-slate-500 font-semibold mb-3 uppercase tracking-wider">${item.location}</p>
                        <p class="text-sm text-slate-600 leading-relaxed">${item.description}</p>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        function filterAttractions(category) { renderAttractions(category); }

        // --- BUDGET CALCULATOR ---
        function initBudgetCalc() {
            const inputs = ['days', 'accom', 'food', 'gas'];
            inputs.forEach(id => {
                document.getElementById(`input-${id}`).addEventListener('input', (e) => {
                    document.getElementById(`val-${id}`).innerText = e.target.value;
                    updateBudget();
                });
            });

            const ctx = document.getElementById('budgetChart').getContext('2d');
            budgetChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: ['Transport', 'Accommodation', 'Food', 'Fun/Ferry'],
                    datasets: [{
                        data: [10, 10, 10, 10],
                        backgroundColor: ['#0891b2', '#f59e0b', '#10b981', '#6366f1'],
                        borderWidth: 0,
                        hoverOffset: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: { callbacks: { label: function(context) { return ' $' + context.raw.toLocaleString(); } } }
                    },
                    cutout: '65%'
                }
            });
            updateBudget();
        }

        function updateBudget() {
            const days = parseInt(document.getElementById('input-days').value);
            const accomPerNight = parseInt(document.getElementById('input-accom').value);
            const foodPerPerson = parseInt(document.getElementById('input-food').value);
            const gasPrice = parseFloat(document.getElementById('input-gas').value);

            const people = 6;
            const kmDistance = 3500; 
            const fuelEfficiency = 11;
            const ferryAndFun = 150 + (days * 60);

            const gasCost = Math.round((kmDistance / 100) * fuelEfficiency * gasPrice);
            const accomCost = accomPerNight * days;
            const foodCost = foodPerPerson * people * days;
            const totalCost = gasCost + accomCost + foodCost + ferryAndFun;
            const perPerson = Math.round(totalCost / people);

            document.getElementById('total-cost').innerText = '$' + totalCost.toLocaleString();
            document.getElementById('per-person-cost').innerText = '$' + perPerson.toLocaleString();
            document.getElementById('stat-transport').innerText = '$' + gasCost;
            document.getElementById('stat-accom').innerText = '$' + accomCost;
            document.getElementById('stat-food').innerText = '$' + foodCost;
            document.getElementById('stat-fun').innerText = '$' + ferryAndFun;

            budgetChartInstance.data.datasets[0].data = [gasCost, accomCost, foodCost, ferryAndFun];
            budgetChartInstance.update();
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderAttractions('all');
            initBudgetCalc();
            initMap();
            switchTab('route');
        });

    </script>
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
</body>
</html>