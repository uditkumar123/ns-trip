<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>Maritime Explorer: Nature Edition</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f8fafc; }
        .tab-active { border-bottom: 3px solid #db2777; color: #be185d; font-weight: 700; background-color: rgba(219, 39, 119, 0.05); }
        .tab-inactive { color: #64748b; font-weight: 500; }
        .tab-inactive:hover { color: #334155; background-color: #f1f5f9; }
        #map { width: 100%; height: 400px; border-radius: 0.75rem; z-index: 1; }
        .timeline-line { position: absolute; left: 24px; top: 20px; bottom: 0; width: 2px; background-color: #e2e8f0; z-index: 0; }
        .hero-bg { background-image: linear-gradient(rgba(190, 24, 93, 0.85), rgba(88, 28, 135, 0.8)), url('https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?q=80&w=1920&auto=format&fit=crop'); background-size: cover; background-position: center 40%; }
        #login-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(15, 23, 42, 0.98); z-index: 9999; display: flex; justify-content: center; align-items: center; }
        @keyframes pulse-red { 0% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0.7); } 70% { box-shadow: 0 0 0 10px rgba(220, 38, 38, 0); } 100% { box-shadow: 0 0 0 0 rgba(220, 38, 38, 0); } }
        .animate-pulse-red { animation: pulse-red 2s infinite; }
        /* Smooth Details Toggle */
        details > summary { list-style: none; cursor: pointer; }
        details > summary::-webkit-details-marker { display: none; }
        details[open] summary ~ * { animation: slideDown 0.3s ease-in-out; }
        @keyframes slideDown { 0% { opacity: 0; transform: translateY(-10px); } 100% { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="text-slate-800">

    <!-- PASSWORD OVERLAY -->
    <div id="login-overlay">
        <div class="bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full text-center border-4 border-pink-500/20">
            <div class="text-5xl mb-6">üîí</div>
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Maritime Planner</h2>
            <p class="text-sm text-slate-500 mb-6">Enter password to view itinerary.</p>
            <input type="password" id="password-input" placeholder="Enter password" class="w-full p-3 border border-slate-300 rounded-lg mb-4 focus:ring-2 focus:ring-pink-500 outline-none transition text-center text-lg">
            <button onclick="checkPassword()" class="w-full bg-pink-700 text-white font-bold py-3 rounded-lg hover:bg-pink-800 transition shadow-lg transform active:scale-95">Unlock Plan</button>
            <p id="error-msg" class="text-red-500 text-xs mt-3 hidden font-bold">Incorrect password.</p>
        </div>
    </div>

    <!-- MAIN APP CONTAINER -->
    <div id="app-container" class="hidden max-w-7xl mx-auto min-h-screen flex flex-col bg-slate-50 shadow-2xl my-0 md:my-8 rounded-2xl overflow-hidden">
        
        <!-- Hero Header -->
        <header class="hero-bg text-white p-8 md:p-12 shadow-lg">
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center">
                <div>
                    <h1 class="text-4xl md:text-5xl font-bold tracking-tight mb-2">The Nature Loop</h1>
                    <p class="text-pink-100 text-xl font-light">Ottawa &#8594; PEI Wildlife &#8594; Fundy &#8594; Ottawa</p>
                </div>
                <div class="mt-6 md:mt-0 bg-white/10 backdrop-blur-md px-6 py-3 rounded-xl border border-white/20">
                    <span class="block text-xs text-pink-200 uppercase tracking-widest font-bold mb-1">Trip Profile</span>
                    <div class="flex items-center space-x-6">
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">üöô</span>
                            <span class="font-bold">Kia Sportage</span>
                        </div>
                        <div class="flex items-center">
                            <span class="text-2xl mr-2">ü¶Ö</span>
                            <span class="font-bold">Nature Focus</span>
                        </div>
                    </div>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="bg-white border-b border-slate-200 sticky top-0 z-50 shadow-sm">
            <div class="flex overflow-x-auto px-4 md:px-8">
                <button onclick="switchTab('route')" id="tab-route" class="tab-active py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üó∫Ô∏è</span> Daily Itinerary</button>
                <button onclick="switchTab('budget')" id="tab-budget" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üí∞</span> Budget</button>
                <button onclick="switchTab('attractions')" id="tab-attractions" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">ü¶Ö</span> Wildlife Spots</button>
                <button onclick="switchTab('logistics')" id="tab-logistics" class="tab-inactive py-5 px-6 whitespace-nowrap transition-all flex items-center"><span class="mr-2">üìã</span> Logistics <span class="ml-2 bg-red-500 text-white text-[10px] px-1 rounded animate-pulse">!</span></button>
            </div>
        </nav>

        <!-- Main Content Area -->
        <main class="flex-grow p-4 md:p-8">

            <!-- TAB: ROUTE (Detailed Itinerary) -->
            <section id="content-route" class="space-y-8 animate-fade-in">
                
                <div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-100 mb-8">
                    <div id="map"></div>
                </div>
                
                <!-- Day by Day Timeline -->
                <div class="relative space-y-4" id="itinerary-list">
                    <!-- Day 1 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden" open>
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-pink-600 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">1</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Sat, Aug 15: The Great Escape</h3>
                                <p class="text-sm text-slate-500">Ottawa &#8594; Trapper's Cabin (715 km)</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">07:00</span><span>Depart Ottawa. Get on the 417 East.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">12:30</span><span><strong>Lunch in Rivi√®re-du-Loup:</strong> Stop at <em>Parc de la Pointe</em>. <br><span class="text-green-600 font-bold text-xs">ü¶Ö Birding:</span> Look for Eiders and Gulls near the marina.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">16:00</span><span><strong>Grand Falls, NB:</strong> Grocery Run (IGA). Last chance for supplies!</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">17:30</span><span><strong>Arrive Upper Kintore:</strong> Check into Trapper's Cabin (Booked). <br><span class="text-green-600 font-bold text-xs">ü¶â Nature:</span> Listen for Barred Owls at dusk. Off-grid night.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 2 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-amber-500 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">2</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Sun, Aug 16: Bridge to the Island</h3>
                                <p class="text-sm text-slate-500">NB &#8594; Stanhope, PEI (400 km)</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">09:00</span><span>Depart Cabin. Drive South to Fredricton/Moncton route.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">13:00</span><span><strong>Cape Jourimain Nature Centre:</strong> (Before Bridge). <br><span class="text-green-600 font-bold text-xs">ü¶Ö Birding:</span> Prime spot for Ospreys and Bald Eagles nesting near the bridge pillars.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">15:00</span><span>Cross Confederation Bridge ($0 entry). Drive to Stanhope.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">17:00</span><span><strong>Camp Setup:</strong> Stanhope Campground. <br><span class="text-green-600 font-bold text-xs">ü¶ä Nature:</span> Watch for Red Foxes near the dunes (do not feed!). Sunset on the beach.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 3 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-amber-500 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">3</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Mon, Aug 17: Dunes & Family</h3>
                                <p class="text-sm text-slate-500">Stanhope Area (Local driving)</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">08:00</span><span><strong>Greenwich Dunes Trail:</strong> (20 min drive). Floating boardwalks. <br><span class="text-green-600 font-bold text-xs">üê¶ Birding:</span> Piping Plovers (endangered) nesting on beaches. Keep distance.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">12:00</span><span>Visit Udit's Aunt.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">16:00</span><span><strong>Covehead Harbour:</strong> Fresh seafood on the wharf. <br><span class="text-green-600 font-bold text-xs">ü¶Ö Birding:</span> Terns and Cormorants fishing in the harbour.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 4 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-green-600 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">4</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Tue, Aug 18: Seals & City</h3>
                                <p class="text-sm text-slate-500">Move to Charlottetown B&B</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">10:00</span><span>Pack up camp. Drive East.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">11:30</span><span><strong>Point Prim Lighthouse:</strong> Oldest in PEI. <br><span class="text-green-600 font-bold text-xs">ü¶≠ Wildlife:</span> Grey Seals haul out on the rocks at low tide here. Bring binoculars!</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">15:00</span><span>Check into Charlottetown B&B. Shower!</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">18:00</span><span><strong>Victoria Park:</strong> Walk the boardwalk. Look for Great Blue Herons. Dinner on Victoria Row.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 5 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-green-600 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">5</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Wed, Aug 19: Singing Sands & Bison</h3>
                                <p class="text-sm text-slate-500">Eastern PEI Day Trip</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">10:00</span><span>Drive East to <strong>Basin Head</strong>. The sand "sings" when you walk. Jump off the bridge into the run.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">14:00</span><span><strong>Buffaloland Provincial Park:</strong> (Montague). <br><span class="text-green-600 font-bold text-xs">ü¶¨ Wildlife:</span> See the herd of Bison (Buffalo) maintained by the province.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">18:00</span><span>Dinner in St. Peters Bay. Return to Charlottetown.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 6 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-teal-600 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">6</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Thu, Aug 20: Tides & Falcons</h3>
                                <p class="text-sm text-slate-500">PEI &#8594; Alma, NB (Fundy)</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">09:00</span><span>Depart PEI via Bridge ($50.25 Toll).</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">12:00</span><span><strong>Hopewell Rocks:</strong> Walk ocean floor (Low tide dependent). <br><span class="text-green-600 font-bold text-xs">ü¶Ö Birding:</span> Peregrine Falcons nest on the flowerpot rocks. Watch for them diving!</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">16:00</span><span>Drive to Alma. Check into motel/cottage.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">17:00</span><span><strong>Fundy National Park:</strong> Quick hike (Dickson Falls). <br><span class="text-green-600 font-bold text-xs">ü´é Wildlife:</span> High chance of seeing Moose at dusk on Hwy 114.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 7 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-blue-600 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">7</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Fri, Aug 21: Whales & Sunsets</h3>
                                <p class="text-sm text-slate-500">Alma &#8594; Rivi√®re-du-Loup (4.5h Drive)</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <ul class="space-y-4 text-sm text-slate-700">
                                <li class="flex"><span class="font-bold w-20 text-slate-400">09:00</span><span>Breakfast (Sticky Buns in Alma). Scenic drive through Fundy Park.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">14:00</span><span>Arrive Rivi√®re-du-Loup. Check into hotel.</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">16:00</span><span><strong>Whale Watching:</strong> Go to the RDL Pier/Marina. <br><span class="text-green-600 font-bold text-xs">üêã Wildlife:</span> You can often see Beluga Whales and Minke Whales right from the shore here!</span></li>
                                <li class="flex"><span class="font-bold w-20 text-slate-400">19:00</span><span>Sunset dinner by the St. Lawrence River.</span></li>
                            </ul>
                        </div>
                    </details>

                    <!-- Day 8 -->
                    <details class="group bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <summary class="flex items-center p-4 bg-slate-50 cursor-pointer select-none">
                            <div class="bg-slate-700 text-white font-bold w-12 h-12 rounded-lg flex items-center justify-center text-xl shadow-md z-10">8</div>
                            <div class="ml-4 flex-grow">
                                <h3 class="font-bold text-slate-800 text-lg">Sat, Aug 22: Homeward Bound</h3>
                                <p class="text-sm text-slate-500">Rivi√®re-du-Loup &#8594; Ottawa (6h Drive)</p>
                            </div>
                            <div class="text-slate-400 transform group-open:rotate-180 transition-transform">‚ñº</div>
                        </summary>
                        <div class="p-6 border-t border-slate-100">
                            <p class="text-sm text-slate-600">Easy highway drive. Stop in Quebec City or Montreal for lunch if desired. Arrive home relaxed.</p>
                        </div>
                    </details>
                </div>
            </section>

            <!-- TAB: BUDGET -->
            <section id="content-budget" class="hidden space-y-8 animate-fade-in">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Controls -->
                    <div class="lg:col-span-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-100">
                        <h2 class="text-xl font-bold text-slate-800 mb-4">Cost Estimator</h2>
                        <div class="space-y-6">
                            <!-- ACCOMMODATION FIXED COST ALERT -->
                            <div class="space-y-2">
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex justify-between items-center">
                                    <span class="text-xs font-bold text-green-800 uppercase">Night 1 (Cabin)</span>
                                    <span class="text-sm font-bold text-green-700">$116</span>
                                </div>
                                <div class="bg-green-50 border border-green-200 rounded-lg p-3 flex justify-between items-center">
                                    <span class="text-xs font-bold text-green-800 uppercase">Camping (2 Nts)</span>
                                    <span class="text-sm font-bold text-green-700">~$100</span>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Total Trip Duration (Days)</span>
                                    <span id="val-days" class="text-pink-600 font-bold">8</span>
                                </label>
                                <input type="range" id="input-days" min="5" max="14" value="8" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-pink-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Remaining 4 Nights (B&Bs)</span>
                                    <span class="text-pink-600 font-bold">$<span id="val-accom">180</span></span>
                                </label>
                                <input type="range" id="input-accom" min="120" max="400" step="10" value="180" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-pink-600">
                                <p class="text-xs text-slate-400 mt-1">Charlottetown, Alma, Riv-du-Loup</p>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Food / Person / Day</span>
                                    <span class="text-pink-600 font-bold">$<span id="val-food">75</span></span>
                                </label>
                                <input type="range" id="input-food" min="40" max="200" step="5" value="75" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-pink-600">
                            </div>

                            <div>
                                <label class="block text-sm font-semibold text-slate-700 mb-2 flex justify-between">
                                    <span>Gas Price</span>
                                    <span class="text-pink-600 font-bold">$<span id="val-gas">1.65</span></span>
                                </label>
                                <input type="range" id="input-gas" min="1.30" max="2.20" step="0.05" value="1.65" class="w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer accent-pink-600">
                            </div>
                        </div>

                        <div class="mt-8 pt-6 border-t border-slate-100">
                            <div class="flex justify-between items-end mb-2">
                                <span class="text-slate-600 font-medium">Total Cost</span>
                                <span id="total-cost" class="text-3xl font-bold text-slate-800">$0</span>
                            </div>
                            <div class="flex justify-between items-end bg-pink-50 p-3 rounded-lg">
                                <span class="text-pink-800 text-sm font-medium">Per Person</span>
                                <span id="per-person-cost" class="text-xl font-bold text-pink-700">$0</span>
                            </div>
                        </div>
                    </div>

                    <!-- Visualization -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-2xl shadow-sm border border-slate-100 flex flex-col justify-center">
                        <div class="relative w-full max-w-[500px] mx-auto h-[350px]">
                            <canvas id="budgetChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TAB: ATTRACTIONS -->
            <section id="content-attractions" class="hidden space-y-8 animate-fade-in">
                <div class="flex flex-col md:flex-row justify-between items-center mb-6">
                    <div>
                        <h2 class="text-2xl font-bold text-slate-800">Wildlife & Nature Spots</h2>
                        <p class="text-slate-600" id="attraction-subtitle">Your target species for this trip.</p>
                    </div>
                    <div class="flex space-x-2 mt-4 md:mt-0 flex-wrap gap-2">
                        <button onclick="renderAttractions('all')" class="px-4 py-2 text-sm bg-slate-800 text-white rounded-full">All</button>
                        <button onclick="renderAttractions('birds')" class="px-4 py-2 text-sm bg-white border border-blue-200 text-blue-700 rounded-full font-bold">Birding</button>
                        <button onclick="renderAttractions('mammals')" class="px-4 py-2 text-sm bg-white border border-amber-200 text-amber-700 rounded-full font-bold">Mammals</button>
                    </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8" id="attraction-grid"></div>
            </section>

            <!-- TAB: LOGISTICS -->
            <section id="content-logistics" class="hidden space-y-8 animate-fade-in">
                <!-- CRITICAL BOOKING ALERT -->
                <div class="bg-red-50 border-l-4 border-red-500 p-6 rounded-r-xl shadow-sm mb-8 animate-pulse-red">
                    <div class="flex items-start">
                        <div class="text-3xl mr-4">‚è∞</div>
                        <div>
                            <h3 class="text-xl font-bold text-red-700">CRITICAL: Stanhope Booking</h3>
                            <p class="text-sm text-red-900 mt-1 font-semibold">Parks Canada Reservations Open: <span class="underline">Feb 9th @ 7:00 AM ET</span>.</p>
                            <p class="text-xs text-red-800 mt-2">Target: Stanhope Campground (North Shore). Create account beforehand.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Night 1 Confirmed -->
                <div class="bg-white rounded-2xl shadow-lg border border-green-100 mb-8 overflow-hidden">
                    <div class="bg-green-700 p-4 text-white flex justify-between items-center">
                        <h3 class="text-lg font-bold flex items-center"><span class="text-2xl mr-2">‚úÖ</span> Night 1: Trapper's Cabin</h3>
                        <span class="bg-white/20 text-xs px-2 py-1 rounded uppercase font-bold">Booked</span>
                    </div>
                    <div class="p-6">
                        <div class="flex items-center text-sm text-slate-700 mb-2">
                            <span class="font-bold mr-2">Vehicle:</span> Kia Sportage (High clearance for access).
                        </div>
                        <div class="flex items-center text-sm text-slate-700">
                            <span class="font-bold mr-2">Prep:</span> No stores on site. Shop in Grand Falls.
                        </div>
                    </div>
                </div>
            </section>
        </main>
        
        <footer class="bg-slate-800 text-slate-400 p-8 text-center text-sm">
            <p>&copy; 2026 Maritime Trip Planner.</p>
        </footer>
    </div>

    <script>
        // --- ASSETS ---
        const assets = {
            aunt: 'https://images.unsplash.com/photo-1542318859-99c08d984143?q=80&w=800&auto=format&fit=crop',
            anne: 'https://images.unsplash.com/photo-1599946347371-68eb71b16afc?q=80&w=800&auto=format&fit=crop', 
            plover: 'https://images.unsplash.com/photo-1552353617-3913788a1834?q=80&w=800&auto=format&fit=crop', // Bird
            bison: 'https://images.unsplash.com/photo-1505238240580-c0812e12822a?q=80&w=800&auto=format&fit=crop', // Bison
            osprey: 'https://images.unsplash.com/photo-1535083252457-6080fe29be45?q=80&w=800&auto=format&fit=crop', // Osprey
            seal: 'https://images.unsplash.com/photo-1563200767-17b070921869?q=80&w=800&auto=format&fit=crop', // Seal
            beluga: 'https://images.unsplash.com/photo-1568430462989-44163eb1752f?q=80&w=800&auto=format&fit=crop', // Beluga/Whale
            fox: 'https://images.unsplash.com/photo-1474511320723-9a56873867b5?q=80&w=800&auto=format&fit=crop', // Red Fox
            peregrine: 'https://images.unsplash.com/photo-1619623696803-b097b667232c?q=80&w=800&auto=format&fit=crop' // Falcon
        };

        const attractions = [
            { title: "Piping Plovers", cat: "birds", loc: "Greenwich Dunes (PEI)", img: assets.plover, desc: "Endangered shorebirds nesting on beaches. Bring binoculars." },
            { title: "Ospreys & Eagles", cat: "birds", loc: "Cape Jourimain (NB)", img: assets.osprey, desc: "Nesting on platforms near Confederation Bridge." },
            { title: "Grey Seals", cat: "mammals", loc: "Point Prim (PEI)", img: assets.seal, desc: "Often seen hauled out on rocks near the lighthouse at low tide." },
            { title: "Red Foxes", cat: "mammals", loc: "Stanhope Camp (PEI)", img: assets.fox, desc: "Famous PEI red foxes are common here. Observe from distance." },
            { title: "Peregrine Falcons", cat: "birds", loc: "Hopewell Rocks (NB)", img: assets.peregrine, desc: "They nest on the flowerpot rock cliffs. Fastest bird in the world." },
            { title: "Beluga Whales", cat: "mammals", loc: "Rivi√®re-du-Loup (QC)", img: assets.beluga, desc: "Visible from the pier/marina! White whales in the St. Lawrence." },
            { title: "Bison Herd", cat: "mammals", loc: "Buffaloland (PEI)", img: assets.bison, desc: "A provincial park herd near Montague. Easy viewing." }
        ];

        // --- MAP LOGIC ---
        let mapInstance = null;
        function initLeafletMap() {
            if (mapInstance) return;
            mapInstance = L.map('map', { scrollWheelZoom: false }).setView([46.8, -66], 6);
            L.tileLayer('https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png', { attribution: '&copy; OpenStreetMap', subdomains: 'abcd', maxZoom: 19 }).addTo(mapInstance);

            const locs = {
                ottawa: [45.4215, -75.6972],
                trapper: [46.7, -67.6],
                stanhope: [46.4, -63.1],
                charlottetown: [46.2, -63.1],
                alma: [45.6, -64.9], 
                rdl: [47.8, -69.5], 
                bridge: [46.2, -63.7]
            };

            // Leg 1: Ottawa -> Trapper
            L.polyline([locs.ottawa, [46.8, -71.2], locs.trapper], {color: '#db2777', weight: 5}).addTo(mapInstance);
            
            // Leg 2: Trapper -> Stanhope (Into PEI)
            L.polyline([locs.trapper, locs.bridge, locs.stanhope], {color: '#db2777', weight: 5}).addTo(mapInstance);

            // Leg 3: Return via Fundy (Alma) -> RDL -> Home
            L.polyline([locs.charlottetown, locs.bridge, locs.alma], {color: '#059669', weight: 5}).addTo(mapInstance);
            L.polyline([locs.alma, locs.rdl], {color: '#059669', weight: 5}).addTo(mapInstance);
            L.polyline([locs.rdl, locs.ottawa], {color: '#64748b', weight: 3, dashArray: '5, 10'}).addTo(mapInstance);

            L.marker(locs.ottawa).addTo(mapInstance).bindPopup("Ottawa");
            L.marker(locs.trapper).addTo(mapInstance).bindPopup("Trapper's Cabin (Night 1)");
            L.marker(locs.stanhope).addTo(mapInstance).bindPopup("Stanhope Camp (Nights 2-3)");
            L.marker(locs.alma).addTo(mapInstance).bindPopup("Fundy/Alma (Night 6)");
            L.marker(locs.rdl).addTo(mapInstance).bindPopup("Rivi√®re-du-Loup (Night 7)");
        }

        // --- BUDGET ---
        let budgetChartInstance = null;
        function updateBudget() {
            const inputs = ['days', 'accom', 'food', 'gas'];
            const vals = {};
            inputs.forEach(id => vals[id] = parseFloat(document.getElementById(`input-${id}`)?.value || 0));
            
            // Fixed Costs
            const trapper = 116;
            const camping = 100; 
            const fixedAccom = trapper + camping;
            
            // Variable Costs
            let km = 2850; 
            let fuel = 9.5; // Sportage
            let gas = Math.round((km/100) * fuel * vals.gas);
            let bridge = 50.25; 
            
            // Accom Remainder: 7 Nights Total - 1 (Cabin) - 2 (Camp) = 4 Nights variable
            let remDays = Math.max(0, vals.days - 3); 
            let varAccom = remDays * vals.accom;
            
            let total = gas + bridge + fixedAccom + varAccom + (vals.food * 2 * vals.days);
            
            document.getElementById('total-cost').innerText = '$' + total.toLocaleString();
            document.getElementById('per-person-cost').innerText = '$' + Math.round(total/2).toLocaleString();
            
            if(budgetChartInstance) {
                budgetChartInstance.data.datasets[0].data = [gas, fixedAccom + varAccom, vals.food*2*vals.days, bridge + 150];
                budgetChartInstance.update();
            }
        }

        function initBudgetCalc() {
            const ctx = document.getElementById('budgetChart').getContext('2d');
            budgetChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: { labels: ['Transport', 'Stay', 'Food', 'Fun'], datasets: [{ data: [1,1,1,1], backgroundColor: ['#0891b2', '#f59e0b', '#10b981', '#6366f1'] }] },
                options: { responsive: true, maintainAspectRatio: false, cutout: '70%' }
            });
            ['days', 'accom', 'food', 'gas'].forEach(id => document.getElementById(`input-${id}`).addEventListener('input', updateBudget));
            updateBudget();
        }

        // --- ATTRACTIONS ---
        function renderAttractions(filter) {
            const grid = document.getElementById('attraction-grid');
            grid.innerHTML = '';
            attractions.forEach(item => {
                if(filter !== 'all' && item.cat !== filter) return;
                const card = document.createElement('div');
                card.className = "bg-white rounded-xl shadow-lg border border-slate-100 overflow-hidden group hover:-translate-y-1 transition";
                
                card.innerHTML = `
                    <div class="h-48 overflow-hidden relative">
                        <img src="${item.img}" class="w-full h-full object-cover transition duration-500 group-hover:scale-110" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                        <div class="img-fallback w-full h-full absolute inset-0 hidden"><span>Image Unavailable</span></div>
                        <div class="absolute top-2 right-2 bg-white/90 text-xs font-bold px-2 py-1 rounded shadow">${item.cat === 'birds' ? 'üê¶ Birding' : 'üêæ Mammal'}</div>
                    </div>
                    <div class="p-6">
                        <h3 class="text-lg font-bold text-slate-800">${item.title}</h3>
                        <p class="text-xs font-bold text-slate-400 uppercase mb-2">üìç ${item.loc}</p>
                        <p class="text-sm text-slate-600">${item.desc}</p>
                    </div>
                `;
                grid.appendChild(card);
            });
        }

        // --- PASSWORD ---
        function checkPassword() {
            if (document.getElementById('password-input').value.toLowerCase() === 'maritime') {
                document.getElementById('login-overlay').style.display = 'none';
                document.getElementById('app-container').classList.remove('hidden');
                setTimeout(() => { initLeafletMap(); initBudgetCalc(); }, 100);
            } else {
                document.getElementById('error-msg').classList.remove('hidden');
            }
        }
        document.getElementById('password-input').addEventListener('keypress', (e) => { if(e.key==='Enter') checkPassword(); });

        function switchTab(id) {
            ['route','budget','attractions','logistics'].forEach(t => {
                document.getElementById(`content-${t}`).classList.add('hidden');
                document.getElementById(`tab-${t}`).classList.remove('tab-active');
                document.getElementById(`tab-${t}`).classList.add('tab-inactive');
            });
            document.getElementById(`content-${id}`).classList.remove('hidden');
            document.getElementById(`tab-${id}`).classList.add('tab-active');
            if (id === 'route' && mapInstance) setTimeout(() => mapInstance.invalidateSize(), 100);
        }

        document.addEventListener('DOMContentLoaded', () => { renderAttractions('all'); });
    </script>
</body>
</html>
